<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Filtrado de spam en mensajes de texto SMS — 31:12 min &mdash; documentación de Cursos de Analítica y Machine Learning - </title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "document", "processHtmlClass": "math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Funciones Teóricas de Probabilidad — 15:51 min" href="2-07_funciones_teoricas_de_probabilidad.html" />
    <link rel="prev" title="Probabilidad condicional, Naive Bayes y Clasificadores de Texto — 42:12 min" href="2-05_bayes_texto.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos-de-analitica/index.html">Fundamentos de Analítica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Algoritmos Bioinspirados</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../analitica-de-grandes-datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica-predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos Aplicada</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-01-2021-10-08">Sesión 01 — 2021-10-08</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-02-2021-10-15">Sesión 02 — 2021-10-15</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-03-2021-10-22">Sesión 03 — 2021-10-22</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-04-2021-10-29">Sesión 04 — 2021-10-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-05-2021-11-05">Sesión 05 — 2021-11-05</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-06-2021-11-12">Sesión 06 — 2021-11-12</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-07-2021-11-19">Sesión 07 — 2021-11-19</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../ciencia-de-los-datos/index.html#sesion-08-2021-11-26">Sesión 08 — 2021-11-26</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_avanzada/index.html">Analítica Avanzada</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../ciencia-de-los-datos/index.html">Ciencia de los Datos Aplicada</a> &raquo;</li>
      <li>Filtrado de spam en mensajes de texto SMS — 31:12 min</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/statistical_thinking/2-06-filtrado-de-mensajes-sms.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Filtrado-de-spam-en-mensajes-de-texto-SMS-—-31:12-min">
<h1>Filtrado de spam en mensajes de texto SMS — 31:12 min<a class="headerlink" href="#Filtrado-de-spam-en-mensajes-de-texto-SMS-—-31:12-min" title="Enlazar permanentemente con este título"></a></h1>
<ul class="simple">
<li><p>31:12 min | Última modificación: Abril 5, 2021 | <a class="reference external" href="https://youtu.be/bl361y9rFNUhttps://youtu.be/bl361y9rFNU">YouTube</a></p></li>
</ul>
<p><strong>Bibliografía.</strong> Machine Learning with R. Brett Lantz, Packt Publishing, Second Edition, 2015.</p>
<p>Los clasificadores Bayesianos ingenuos son herramientas de gran utilidad para la construcción de sistemas de clasificación, como ya se discutio en los tutoriales anteriores. En este tutorial se utiliza un clasificador Bayesiano ingenuo para determinar si un mensaje SMS es válido o es spam.</p>
<div class="section" id="Definición-del-problema">
<h2>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlazar permanentemente con este título"></a></h2>
<p>La recepción de publicidad no deseada a traves mensajes de texto usando SMS (Short Message Service) es un problema que afecta a muchos usuarios de teléfonos móviles. El problema radica en que los usuarios deben pagar por los mesajes recibidos, y por este motivo resulta muy importante que las compañías prestadoras del servicio puedan filtrar mensajes indeseados antes de enviarlos a su destinatario final. Los mensajes tienen una longitud máxima de 160 caracteres, por lo que el texto resulta poco
para realizar la clasificación, en comparación con textos más largos (como los emails). Adicionalmente, los errores de digitación dificultan el proceso de detección automática.</p>
<p>La muestra contiene 5574 mensajes en inglés, no codificados y clasificados como legítimos (ham) o spam (<a class="reference external" href="http://www.dt.fee.unicamp.br/~tiago/smsspamcollection/">http://www.dt.fee.unicamp.br/~tiago/smsspamcollection/</a>). El problema en términos de los datos consiste en clasificar si un mensaje SMS es legítico o spam, a partir del análisis de las palabras que contiente, partiendo del supuesto de que ciertas palabras que son más frecuentes dependiendo del tipo de mensaje. Esto implica que en la fase de preparación de los datos se deben extraer las palabras
que contiene cada mensaje para poder realizar el análsis.</p>
</div>
<div class="section" id="Carga-de-datos">
<h2>Carga de datos<a class="headerlink" href="#Carga-de-datos" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;https://raw.githubusercontent.com/jdvelasq/datalabs/master/datasets/sms-spam.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin-1&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ham</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ham</td>
      <td>Ok lar... Joking wif u oni...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>spam</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ham</td>
      <td>U dun say so early hor... U c already then say...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ham</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Verifica la lectura de los datos</span>
<span class="c1">#</span>
<span class="n">df</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5574</td>
      <td>5574</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>2</td>
      <td>5160</td>
    </tr>
    <tr>
      <th>top</th>
      <td>ham</td>
      <td>Sorry, I'll call later</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>4827</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Conteo-de-cantidad-de-mensajes-por-tipo">
<h2>Conteo de cantidad de mensajes por tipo<a class="headerlink" href="#Conteo-de-cantidad-de-mensajes-por-tipo" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se obtiene la cantidad de casos para</span>
<span class="c1"># cada tipo de mensaje.</span>
<span class="c1">#</span>
<span class="n">df</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ham     4827
spam     747
Name: type, dtype: int64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_statistical_thinking_2-06-filtrado-de-mensajes-sms_11_0.png" src="../../_images/notebooks_statistical_thinking_2-06-filtrado-de-mensajes-sms_11_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se convierte el conteo anterior en probabilidades.</span>
<span class="c1">#</span>
<span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ham     86.6
spam    13.4
Name: type, dtype: float64
</pre></div></div>
</div>
</div>
<div class="section" id="Stemmer">
<h2>Stemmer<a class="headerlink" href="#Stemmer" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">nltk.stem.porter</span> <span class="kn">import</span> <span class="n">PorterStemmer</span>

<span class="c1">#</span>
<span class="c1"># Se construye un stemmer que reduce una palabra a su raiz o &#39;stem&#39;.</span>
<span class="c1"># {llorar, lloramos, lloraron} -&gt; llorar</span>
<span class="c1"># {biblioteca, bibliotecario} -&gt; bibliotec</span>
<span class="c1">#</span>
<span class="n">stemmer</span> <span class="o">=</span> <span class="n">PorterStemmer</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;stemmed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">stemmer</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">()]))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>type</th>
      <th>text</th>
      <th>stemmed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>ham</td>
      <td>Go until jurong point, crazy.. Available only ...</td>
      <td>Go until jurong point, crazy.. avail onli in b...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>ham</td>
      <td>Ok lar... Joking wif u oni...</td>
      <td>Ok lar... joke wif u oni...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>spam</td>
      <td>Free entry in 2 a wkly comp to win FA Cup fina...</td>
      <td>free entri in 2 a wkli comp to win FA cup fina...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>ham</td>
      <td>U dun say so early hor... U c already then say...</td>
      <td>U dun say so earli hor... U c alreadi then say...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>ham</td>
      <td>Nah I don't think he goes to usf, he lives aro...</td>
      <td>nah I don't think he goe to usf, he live aroun...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>spam</td>
      <td>FreeMsg Hey there darling it's been 3 week's n...</td>
      <td>freemsg hey there darl it' been 3 week' now an...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>ham</td>
      <td>Even my brother is not like to speak with me. ...</td>
      <td>even my brother is not like to speak with me. ...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>ham</td>
      <td>As per your request 'Melle Melle (Oru Minnamin...</td>
      <td>As per your request 'mell mell (oru minnaminun...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>spam</td>
      <td>WINNER!! As a valued network customer you have...</td>
      <td>winner!! As a valu network custom you have bee...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>spam</td>
      <td>Had your mobile 11 months or more? U R entitle...</td>
      <td>had your mobil 11 month or more? U R entitl to...</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Matriz-de-Términos-del-Documento">
<h2>Matriz de Términos del Documento<a class="headerlink" href="#Matriz-de-Términos-del-Documento" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Matriz de términos del documento en Python</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="n">CountVectorizer</span>

<span class="c1">#</span>
<span class="c1"># Stopwords:</span>
<span class="c1">#   i  me  my  myself  we  our  ours  ourselves ....</span>
<span class="c1">#   am  is  are  was  were  be  been  being  have</span>
<span class="c1">#   has  had  having  do  does  did  doing  ...</span>
<span class="c1">#   a  an  the  and  but  if  or  because  as  until</span>
<span class="c1">#   while  of  at  by  for  with  about  against ...</span>
<span class="c1">#   ...</span>
<span class="c1">#</span>
<span class="c1"># token_pattern:</span>
<span class="c1"># https://docs.python.org/3/howto/regex.html#regex-howto</span>
<span class="c1">#</span>
<span class="c1">#   \w cualquier caracter alfanumerico [a-zA-Z0-9_]</span>
<span class="c1">#   \w\w+ cadenas de dos o mas caracteres</span>
<span class="c1">#   \b  word boundary</span>
<span class="c1">#</span>
<span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span>
    <span class="n">analyzer</span><span class="o">=</span><span class="s2">&quot;word&quot;</span><span class="p">,</span>                <span class="c1"># a nivel de palabra</span>
    <span class="n">lowercase</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                 <span class="c1"># convierte a minúsculas</span>
    <span class="n">stop_words</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">,</span>           <span class="c1"># stop_words en inglés</span>
    <span class="n">token_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;(?u)\b\w\w+\b&quot;</span><span class="p">,</span> <span class="c1"># patrones a reconocer</span>
    <span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                    <span class="c1"># Los valores distintos de cero son fijados en 1</span>
    <span class="n">max_df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>                     <span class="c1"># máxima frecuencia a considerar</span>
    <span class="n">min_df</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>                       <span class="c1"># ignora palabras con baja frecuencia</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Aplica la función al texto</span>
<span class="c1">#</span>
<span class="n">dtm</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">stemmed</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Las filas contienen los mensajes</span>
<span class="c1"># y las clomunas los términos</span>
<span class="c1">#</span>
<span class="n">dtm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5574, 1540)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Palabras aprendidas de los mensajes de texto</span>
<span class="c1">#</span>
<span class="n">vocabulary</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="nb">len</span><span class="p">(</span><span class="n">vocabulary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1540
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Primeras palabras del vocabulario</span>
<span class="c1">#</span>
<span class="n">vocabulary</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;00&#39;,
 &#39;000&#39;,
 &#39;02&#39;,
 &#39;03&#39;,
 &#39;04&#39;,
 &#39;06&#39;,
 &#39;0800&#39;,
 &#39;08000839402&#39;,
 &#39;08000930705&#39;,
 &#39;0870&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se puede mejorar diciendo que solo se reconozcan</span>
<span class="c1"># palabras formadas por letras</span>
<span class="c1">#</span>
<span class="n">count_vect</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">(</span>
    <span class="n">analyzer</span><span class="o">=</span><span class="s2">&quot;word&quot;</span><span class="p">,</span>
    <span class="n">lowercase</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">stop_words</span><span class="o">=</span><span class="s2">&quot;english&quot;</span><span class="p">,</span>
    <span class="n">token_pattern</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;(?u)\b[a-zA-Z][a-zA-Z]+\b&quot;</span><span class="p">,</span>
    <span class="n">binary</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">max_df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
    <span class="n">min_df</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">dtm</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">stemmed</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Las filas contienen los mensajes</span>
<span class="c1"># y las clomunas los términos</span>
<span class="c1">#</span>
<span class="n">dtm</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5574, 1423)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">vocabulary</span> <span class="o">=</span> <span class="n">count_vect</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">vocabulary</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&#39;aathi&#39;,
 &#39;abiola&#39;,
 &#39;abl&#39;,
 &#39;abt&#39;,
 &#39;ac&#39;,
 &#39;acc&#39;,
 &#39;accept&#39;,
 &#39;access&#39;,
 &#39;account&#39;,
 &#39;act&#39;]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Recupera los mensajes de la dtm</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">dtm2words</span><span class="p">(</span><span class="n">dtm</span><span class="p">,</span> <span class="n">vocabulary</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
    <span class="n">as_list</span> <span class="o">=</span> <span class="n">dtm</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">docs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
        <span class="n">k</span> <span class="o">=</span> <span class="p">[</span><span class="n">vocabulary</span><span class="p">[</span><span class="n">iword</span><span class="p">]</span> <span class="k">for</span> <span class="n">iword</span><span class="p">,</span> <span class="n">ifreq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">as_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="n">ifreq</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">docs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">docs</span>


<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dtm2words</span><span class="p">(</span><span class="n">dtm</span><span class="p">,</span> <span class="n">vocabulary</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Org: &quot;</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mod: &quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Org:  Go until jurong point, crazy.. Available only in bugis n great world la e buffet... Cine there got amore wat...
Mod:  avail bugi cine got great la onli point wat world

Org:  Ok lar... Joking wif u oni...
Mod:  joke lar ok wif

Org:  Free entry in 2 a wkly comp to win FA Cup final tkts 21st May 2005. Text FA to 87121 to receive entry question(std txt rate)T&amp;C&#39;s apply 08452810075over18&#39;s
Mod:  appli comp cup entri final free question rate receiv std text txt win wkli

Org:  U dun say so early hor... U c already then say...
Mod:  alreadi dun earli say

Org:  Nah I don&#39;t think he goes to usf, he lives around here though
Mod:  don goe live nah think usf

Org:  FreeMsg Hey there darling it&#39;s been 3 week&#39;s now and no word back! I&#39;d like some fun you up for it still? Tb ok! XxX std chgs to send, Â£1.50 to rcv
Mod:  darl freemsg fun hey like ok send std week word xxx

Org:  Even my brother is not like to speak with me. They treat me like aids patent.
Mod:  brother like speak treat

Org:  As per your request &#39;Melle Melle (Oru Minnaminunginte Nurungu Vettam)&#39; has been set as your callertune for all Callers. Press *9 to copy your friends Callertune
Mod:  callers callertun copi friend ha press request set

Org:  WINNER!! As a valued network customer you have been selected to receivea Â£900 prize reward! To claim call 09061701461. Claim code KL341. Valid 12 hours only.
Mod:  claim code custom hour network prize reward select valid valu winner

Org:  Had your mobile 11 months or more? U R entitled to Update to the latest colour mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
Mod:  camera colour entitl free latest mobil month updat

Org:  I&#39;m gonna be home soon and i don&#39;t want to talk about this stuff anymore tonight, k? I&#39;ve cried enough today.
Mod:  don gonna home soon stuff talk thi today tonight want

</pre></div></div>
</div>
</div>
<div class="section" id="Conjuntos-de-entrenamiento-y-prueba">
<h2>Conjuntos de entrenamiento y prueba<a class="headerlink" href="#Conjuntos-de-entrenamiento-y-prueba" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Creación de los conjuntos de entrenamiento y prueba.</span>
<span class="c1">#</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">dtm</span><span class="p">[</span>
    <span class="mi">0</span><span class="p">:</span><span class="mi">4168</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">dtm</span><span class="p">[</span>
    <span class="mi">4169</span><span class="p">:,</span>
<span class="p">]</span>

<span class="n">y_train_true</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">type</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4168</span><span class="p">]</span>
<span class="n">y_test_true</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">type</span><span class="p">[</span><span class="mi">4169</span><span class="p">:]</span>

<span class="c1">#</span>
<span class="c1"># Distribución de los datos en el conjunto de entrenamiento.</span>
<span class="c1">#</span>
<span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">y_train_true</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_train_true</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ham     86.5
spam    13.5
Name: type, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Distribución de los datos en el conjunto de entrenamiento.</span>
<span class="c1">#</span>
<span class="nb">round</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">y_test_true</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">y_test_true</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()),</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ham     87.0
spam    13.0
Name: type, dtype: float64
</pre></div></div>
</div>
</div>
<div class="section" id="Entrenamiento-del-modelo">
<h2>Entrenamiento del modelo<a class="headerlink" href="#Entrenamiento-del-modelo" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">BernoulliNB</span>

<span class="c1">#</span>
<span class="c1"># Se crea un clasificador Naive Bayes (NB)</span>
<span class="c1">#</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">BernoulliNB</span><span class="p">()</span>

<span class="c1">#</span>
<span class="c1"># Se entrena el clasificador</span>
<span class="c1">#</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">toarray</span><span class="p">(),</span> <span class="n">y_train_true</span><span class="p">)</span>
<span class="n">clf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
BernoulliNB(alpha=1.0, binarize=0.0, class_prior=None, fit_prior=True)
</pre></div></div>
</div>
</div>
<div class="section" id="Evaluación-del-modelo">
<h2>Evaluación del modelo<a class="headerlink" href="#Evaluación-del-modelo" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Se pronostica para los datos de prueba.</span>
<span class="c1">#</span>
<span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="n">y_test_pred_prob</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
<span class="n">y_test_pred</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([&#39;spam&#39;, &#39;ham&#39;, &#39;ham&#39;, ..., &#39;ham&#39;, &#39;ham&#39;, &#39;ham&#39;], dtype=&#39;&lt;U4&#39;)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Métricas de desempeño</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">y_test_pred</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Pronostico en las columnas</span>
<span class="c1"># Real en las filas</span>
<span class="c1">#</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[1213,    9],
       [  17,  166]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">toarray</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[2.56782069e-11, 1.00000000e+00],
       [9.97507164e-01, 2.49283632e-03],
       [9.97748935e-01, 2.25106470e-03],
       ...,
       [9.99944765e-01, 5.52350469e-05],
       [9.99580765e-01, 4.19235040e-04],
       [9.99850227e-01, 1.49773007e-04]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Resulta más conveniente preparar una nueva tabla que</span>
<span class="c1"># muestre la clasificación y no únicamente las</span>
<span class="c1"># probabilidades.</span>
<span class="c1">#</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;actual_type&quot;</span><span class="p">:</span> <span class="n">y_test_true</span><span class="p">,</span>
        <span class="s2">&quot;predict_type&quot;</span><span class="p">:</span> <span class="n">y_test_pred</span><span class="p">,</span>
        <span class="s2">&quot;prob_ham&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y_test_pred_prob</span><span class="p">],</span>
        <span class="s2">&quot;prob_spam&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">y_test_pred_prob</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual_type</th>
      <th>predict_type</th>
      <th>prob_ham</th>
      <th>prob_spam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4169</th>
      <td>spam</td>
      <td>spam</td>
      <td>2.567821e-11</td>
      <td>1.000000e+00</td>
    </tr>
    <tr>
      <th>4170</th>
      <td>ham</td>
      <td>ham</td>
      <td>9.975072e-01</td>
      <td>2.492836e-03</td>
    </tr>
    <tr>
      <th>4171</th>
      <td>ham</td>
      <td>ham</td>
      <td>9.977489e-01</td>
      <td>2.251065e-03</td>
    </tr>
    <tr>
      <th>4172</th>
      <td>ham</td>
      <td>ham</td>
      <td>1.000000e+00</td>
      <td>1.382815e-08</td>
    </tr>
    <tr>
      <th>4173</th>
      <td>ham</td>
      <td>ham</td>
      <td>9.999996e-01</td>
      <td>4.133793e-07</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Mensajes con clasificación errónea.</span>
<span class="c1"># Resulta muy importante determinar porque los</span>
<span class="c1"># mensajes están mal clasificados</span>
<span class="c1">#</span>
<span class="n">results</span><span class="p">[</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;actual_type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;predict_type&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual_type</th>
      <th>predict_type</th>
      <th>prob_ham</th>
      <th>prob_spam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4213</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.996469</td>
      <td>0.003531</td>
    </tr>
    <tr>
      <th>4253</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.137255</td>
      <td>0.862745</td>
    </tr>
    <tr>
      <th>4256</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.831411</td>
      <td>0.168589</td>
    </tr>
    <tr>
      <th>4295</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.783809</td>
      <td>0.216191</td>
    </tr>
    <tr>
      <th>4344</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.075089</td>
      <td>0.924911</td>
    </tr>
    <tr>
      <th>4373</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.950103</td>
      <td>0.049897</td>
    </tr>
    <tr>
      <th>4394</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.932296</td>
      <td>0.067704</td>
    </tr>
    <tr>
      <th>4399</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.086534</td>
      <td>0.913466</td>
    </tr>
    <tr>
      <th>4475</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.619568</td>
      <td>0.380432</td>
    </tr>
    <tr>
      <th>4514</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.998462</td>
      <td>0.001538</td>
    </tr>
    <tr>
      <th>4527</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.691872</td>
      <td>0.308128</td>
    </tr>
    <tr>
      <th>4729</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.014876</td>
      <td>0.985124</td>
    </tr>
    <tr>
      <th>4773</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.000104</td>
      <td>0.999896</td>
    </tr>
    <tr>
      <th>4821</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.582984</td>
      <td>0.417016</td>
    </tr>
    <tr>
      <th>4914</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.924987</td>
      <td>0.075013</td>
    </tr>
    <tr>
      <th>4968</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.995243</td>
      <td>0.004757</td>
    </tr>
    <tr>
      <th>5046</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.002258</td>
      <td>0.997742</td>
    </tr>
    <tr>
      <th>5056</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.443998</td>
      <td>0.556002</td>
    </tr>
    <tr>
      <th>5106</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.266868</td>
      <td>0.733132</td>
    </tr>
    <tr>
      <th>5112</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.990915</td>
      <td>0.009085</td>
    </tr>
    <tr>
      <th>5326</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.161439</td>
      <td>0.838561</td>
    </tr>
    <tr>
      <th>5383</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.998667</td>
      <td>0.001333</td>
    </tr>
    <tr>
      <th>5429</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.998762</td>
      <td>0.001238</td>
    </tr>
    <tr>
      <th>5451</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.959811</td>
      <td>0.040189</td>
    </tr>
    <tr>
      <th>5468</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.818033</td>
      <td>0.181967</td>
    </tr>
    <tr>
      <th>5542</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.998118</td>
      <td>0.001882</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Sin embargo, es mucho más intersante extraer</span>
<span class="c1"># mensajes con probabilidades numéricamente</span>
<span class="c1"># cercanas a 0.5. Estos podrían generar ambiguedad</span>
<span class="c1"># en la clasificación.</span>
<span class="c1">#</span>
<span class="n">results</span><span class="p">[(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;prob_spam&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.4</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;prob_spam&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual_type</th>
      <th>predict_type</th>
      <th>prob_ham</th>
      <th>prob_spam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4821</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.582984</td>
      <td>0.417016</td>
    </tr>
    <tr>
      <th>5056</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.443998</td>
      <td>0.556002</td>
    </tr>
    <tr>
      <th>5122</th>
      <td>spam</td>
      <td>spam</td>
      <td>0.462431</td>
      <td>0.537569</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Mensajes mal clasificados con probabilidad cercana a 0.5</span>
<span class="c1">#</span>
<span class="n">results</span><span class="p">[</span>
    <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;prob_spam&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.4</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;prob_spam&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.6</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s2">&quot;actual_type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">results</span><span class="p">[</span><span class="s2">&quot;predict_type&quot;</span><span class="p">])</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actual_type</th>
      <th>predict_type</th>
      <th>prob_ham</th>
      <th>prob_spam</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4821</th>
      <td>spam</td>
      <td>ham</td>
      <td>0.582984</td>
      <td>0.417016</td>
    </tr>
    <tr>
      <th>5056</th>
      <td>ham</td>
      <td>spam</td>
      <td>0.443998</td>
      <td>0.556002</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p><strong>Pregunta.—</strong> Si en la construcción del clasificador se hace <code class="docutils literal notranslate"><span class="pre">laplace</span> <span class="pre">=</span> <span class="pre">1</span></code>, en cuanto mejora la precisión del modelo.</p>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>