

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="es" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="es" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Inducci√≥n de Reglas de Asociaci√≥n usando 1R &mdash; documentaci√≥n de --- Cursos --- - </title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="../../../_static/translations.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="√çndice" href="../../../genindex.html" />
    <link rel="search" title="B√∫squeda" href="../../../search.html" />
    <link rel="next" title="Identificaci√≥n de hongos venenosos usando 1R" href="02-clasificacion-de-hongos-venenosos-1R.html" />
    <link rel="prev" title="Sesiones" href="../../../analitica-predictiva/content.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> --- Cursos ---
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Configuraci√≥n</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Instalaci√≥n de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-de-grandes-datos/index.html">Anal√≠tica de grandes datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-financiera/index.html">Anal√≠tica Financiera</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analitica-predictiva/index.html">Anal√≠tica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ciencia-de-los-datos/index.html">Ciencia de los Datos</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../fundamentos-de-analitica/index.html">Fundamentos de Anal√≠tica</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../fundamentos-de-analitica/content.html">Sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentos-de-analitica/grades.html">Laboratorios de Programaci√≥n</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../fundamentos-de-analitica/course-info.html">Informaci√≥n del curso</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../productos-de-datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../redes-neuronales-con-tensorflow/index.html">Redes Neuronales Artificiales</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">--- Cursos ---</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/index.html">Anal√≠tica Predictiva</a> &raquo;</li>
        
          <li><a href="../../../analitica-predictiva/content.html">Sesiones</a> &raquo;</li>
        
      <li>Inducci√≥n de Reglas de Asociaci√≥n usando 1R</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/sklearn/oneR/01-induccion-de-reglas-usando-1R.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Inducci√≥n-de-Reglas-de-Asociaci√≥n-usando-1R">
<h1>Inducci√≥n de Reglas de Asociaci√≥n usando 1R<a class="headerlink" href="#Inducci√≥n-de-Reglas-de-Asociaci√≥n-usando-1R" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h1>
<ul class="simple">
<li><p><em>90 min</em> | Ultima modificaci√≥n: Junio 25, 2019</p></li>
</ul>
<p>Las t√©cnicas de clasificaci√≥n son utilizadas para resolver problemas en los cuales se debe determinar a cual clase pertenece una instancia a partir de los valores de sus atributos; entre los casos pr√°cticos de aplicaci√≥n se encuentran: el diagn√≥stico de enfermedades (el paciente tiene o no la enfermedad), la detecci√≥n de fraudes, los sistemas de reconocimiento (el objeto es o no es una persona), el riesgo crediticio (el solicitante pagar√° o no pagar√° la deuda). En este tutorial se presenta el
algoritmo 1R, el cual permite construir un clasificador de referencia basado en reglas de asociaci√≥n, y contra el cual se pueden contrastar los resultados de otros algoritmos m√°s complejos.</p>
<div class="section" id="Descripci√≥n-del-problema">
<h2>Descripci√≥n del problema<a class="headerlink" href="#Descripci√≥n-del-problema" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<p>El problema abordado se desea determina a que clase pertenece una nueva observaci√≥n (<span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span> o <span class="math notranslate nohighlight">\(C\)</span>), con base en una muestra de observaciones recolectada previamente.</p>
<p>Se tiene un conjunto ficticio de 15 ejemplos para los cuales se tienen tres caracter√≠sticas <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span> y <span class="math notranslate nohighlight">\(x_3\)</span> y su respectiva clase. Se desea determinar a que clase pertenece un nuevo punto con coordenadas <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span> y <span class="math notranslate nohighlight">\(x_3\)</span>. Si las clases representan la presencia (o no) de una enfermedad, las variables <span class="math notranslate nohighlight">\(x_i\)</span> prodian representan, por ejemplo, los resultados de los ex√°menes m√©dicos de los pacientes.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%writefile</span> data.csv
<span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">y</span>
<span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">A</span>
<span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">C</span>
<span class="n">a</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">B</span>
<span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">A</span>
<span class="n">a</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">A</span>
<span class="n">a</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">A</span>
<span class="n">a</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">B</span>
<span class="n">b</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">B</span>
<span class="n">b</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">B</span>
<span class="n">b</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">B</span>
<span class="n">b</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">C</span>
<span class="n">c</span><span class="p">,</span><span class="n">e</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">C</span>
<span class="n">c</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">C</span>
<span class="n">c</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">h</span><span class="p">,</span><span class="n">B</span>
<span class="n">c</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">B</span>
<span class="n">c</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">C</span>
<span class="n">d</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">A</span>
<span class="n">d</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">A</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Overwriting data.csv
</pre></div></div>
</div>
</div>
<div class="section" id="Definici√≥n-de-probabilidad-como-frecuencia">
<h2>Definici√≥n de probabilidad como frecuencia<a class="headerlink" href="#Definici√≥n-de-probabilidad-como-frecuencia" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<p><strong>Espacio muestral:</strong> se define como el conjunto de todos los posibles resultados de un experimento.</p>
<p><strong>Pregunta.‚Äî</strong> En la tirada de dos dados, ¬øcu√°l es el espacio muestral?</p>
<p><strong>Evento:</strong> Es cualquier colecci√≥n de posibles resultados de un experimento (subconjunto del espacio muestral).</p>
<p>En su forma m√°s simple, el concepto de probabilidad puede interpretarse como la frecuencia con que ocurre un evento. Por ejempo, si en la tirada de dos dados se definen como un evento la cantidad de posibles resultados que dan una suma determinada, entonces:</p>
<p><img alt="tirada-dados" src="../../../_images/tirada-dados.jpg" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">6</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">36</span>
<span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">7</span><span class="p">)</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span><span class="mi">11</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">36</span>
<span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">8</span><span class="p">)</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">36</span>
<span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">36</span>   <span class="n">Pr</span><span class="p">(</span><span class="n">ùëã</span><span class="o">=</span> <span class="mi">9</span><span class="p">)</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">36</span>
</pre></div>
</div>
<p><strong>Pregunta.‚Äî</strong> Los soldados mediavales apostaban con dos dados de la siguiente manera: si el resultado es par {2, 4, 6, 8, 10, 12} ganaba el soldado A; y si el resultado es impar {3, 5, 7, 9, 11} ganaba el soldado B. ¬øQui√©n tiene mayor probabilidad de ganar?</p>
</div>
<div class="section" id="Propiedades-y-definiciones-b√°sicas-sobre-probabilidad">
<h2>Propiedades y definiciones b√°sicas sobre probabilidad<a class="headerlink" href="#Propiedades-y-definiciones-b√°sicas-sobre-probabilidad" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<ul class="simple">
<li><p>Todas las probabilidades deben estar entre <span class="math notranslate nohighlight">\(0\)</span> y <span class="math notranslate nohighlight">\(1\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[0 \le \text{Pr}(x_i) \le 1\]</div>
<ul class="simple">
<li><p>Las probabilidades de eventos mutuamente exclusivos (no pueden ocurrir simult√°neamente) y colectivamente exhaustivos (cubren todo el universo de casos posibles) deben sumar la unidad:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^n \text{Pr}(x_i) = 1\]</div>
<ul class="simple">
<li><p>Probabilidad condicional <span class="math notranslate nohighlight">\(\text{Pr}(A \; | \; B)\)</span>: probabilidad de que ocurra un evento <span class="math notranslate nohighlight">\(A\)</span> sabiendo que otro evento <span class="math notranslate nohighlight">\(B\)</span> ya ocurrio.</p></li>
<li><p>Independencia: Si los eventos <span class="math notranslate nohighlight">\(A\)</span> y <span class="math notranslate nohighlight">\(B\)</span> son independientes:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{Pr}(A \; |  \; B) = \text{Pr}(A)\]</div>
</div>
<div class="section" id="Reglas-de-asociaci√≥n-para-clasificaci√≥n">
<h2>Reglas de asociaci√≥n para clasificaci√≥n<a class="headerlink" href="#Reglas-de-asociaci√≥n-para-clasificaci√≥n" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<p>La metodolog√≠a 1R se basa en la partici√≥n del espacio de entrada usando una y s√≥lo una de las variables (atributos) del problema. Para el problema planteado, una regla basada en el atributo <code class="docutils literal notranslate"><span class="pre">x1</span></code> podr√≠a ser:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">{</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">}:</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">A</span>
<span class="k">if</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">{</span><span class="n">b</span><span class="p">}:</span>     <span class="n">y</span> <span class="o">=</span> <span class="n">B</span>
<span class="k">if</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">{</span><span class="n">c</span><span class="p">}:</span>     <span class="n">y</span> <span class="o">=</span> <span class="n">C</span>
</pre></div>
</div>
<p>El algoritmo funciona de la siguiente forma: se toma el primer atributo <span class="math notranslate nohighlight">\(x_1\)</span> y se divide en grupos por cada valor que puede tomar dicho atributo, es decir, por <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, <code class="docutils literal notranslate"><span class="pre">c</span></code>, y <code class="docutils literal notranslate"><span class="pre">d</span></code>; para cada atributo se determina a que clase es m√°s probable que pertenezca los ejemplos y se asigna dicha clase a dicho atributo. Es decir, para cada atributo se cuentan cu√°ntos ejemplos hay de cada categor√≠a y se asigna la clase por mayor√≠a, esto es, si hay cuatro ejemplos para la categor√≠a <code class="docutils literal notranslate"><span class="pre">a</span></code> de
<span class="math notranslate nohighlight">\(x_1\)</span> y tres de ellos pertencen a la clase <code class="docutils literal notranslate"><span class="pre">A</span></code> y el restante a <code class="docutils literal notranslate"><span class="pre">C</span></code> se dice que <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">x1</span> <span class="pre">==</span> <span class="pre">a:</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">A</span></code>; esto equivale a decir que si <code class="docutils literal notranslate"><span class="pre">x1</span> <span class="pre">==</span> <span class="pre">a</span></code> es m√°s probable que el ejemplo pertenezca a la clase sea <code class="docutils literal notranslate"><span class="pre">A</span></code>. As√≠, el clasificador basado en este atributo podr√≠a ser escrito como un sistema de reglas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>     <span class="c1">#   x1   x2   x3    y</span>
<span class="o">--------------------------</span>

<span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">a</span><span class="p">:</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">A</span>

     <span class="mi">1</span>    <span class="n">a</span>    <span class="n">g</span>    <span class="n">h</span>    <span class="n">A</span>
     <span class="mi">2</span>    <span class="n">a</span>    <span class="n">e</span>    <span class="n">i</span>    <span class="n">A</span>
     <span class="mi">3</span>    <span class="n">a</span>    <span class="n">f</span>    <span class="n">h</span>    <span class="n">A</span>
    <span class="mi">11</span>    <span class="n">a</span>    <span class="n">e</span>    <span class="n">i</span>    <span class="n">C</span>

<span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">b</span><span class="p">:</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">B</span>

     <span class="mi">6</span>    <span class="n">b</span>    <span class="n">e</span>    <span class="n">i</span>    <span class="n">B</span>
     <span class="mi">7</span>    <span class="n">b</span>    <span class="n">f</span>    <span class="n">i</span>    <span class="n">B</span>
    <span class="mi">12</span>    <span class="n">b</span>    <span class="n">g</span>    <span class="n">j</span>    <span class="n">C</span>
     <span class="mi">8</span>    <span class="n">b</span>    <span class="n">f</span>    <span class="n">i</span>    <span class="n">B</span>

<span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">c</span><span class="p">:</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">C</span>

     <span class="mi">9</span>    <span class="n">c</span>    <span class="n">g</span>    <span class="n">h</span>    <span class="n">B</span>
    <span class="mi">10</span>    <span class="n">c</span>    <span class="n">g</span>    <span class="n">h</span>    <span class="n">B</span>
    <span class="mi">13</span>    <span class="n">c</span>    <span class="n">f</span>    <span class="n">j</span>    <span class="n">C</span>
    <span class="mi">14</span>    <span class="n">c</span>    <span class="n">g</span>    <span class="n">h</span>    <span class="n">C</span>
    <span class="mi">15</span>    <span class="n">c</span>    <span class="n">e</span>    <span class="n">i</span>    <span class="n">C</span>

<span class="k">if</span> <span class="n">x1</span> <span class="o">==</span> <span class="n">d</span><span class="p">:</span>  <span class="n">y</span> <span class="o">=</span> <span class="n">A</span>

     <span class="mi">4</span>    <span class="n">d</span>    <span class="n">f</span>    <span class="n">j</span>    <span class="n">A</span>
     <span class="mi">5</span>    <span class="n">d</span>    <span class="n">g</span>    <span class="n">j</span>    <span class="n">A</span>
</pre></div>
</div>
<p>Al agrupar por <span class="math notranslate nohighlight">\(x_1\)</span>, este conjunto de reglas se reescribe como:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">{</span><span class="n">a</span><span class="p">,</span> <span class="n">d</span><span class="p">}:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">A</span>
<span class="k">elif</span> <span class="n">x1</span> <span class="ow">in</span> <span class="p">{</span><span class="n">b</span><span class="p">}:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">B</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">C</span>
</pre></div>
</div>
<p>Para el clasificador anterior se puede calcular una m√©trica de error.</p>
<p>Luego se toma el segundo atributo <span class="math notranslate nohighlight">\(x_2\)</span> y se procede de igual forma para construir otro clasificador. El proceso se repite hasta obtener un clasificador por cada atributo. Se escoge el clasificador con mayor precisi√≥n.</p>
</div>
<div class="section" id="M√©tricas-de-desempe√±o-de-clasificadores">
<h2>M√©tricas de desempe√±o de clasificadores<a class="headerlink" href="#M√©tricas-de-desempe√±o-de-clasificadores" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<p>Para evaluar el desempe√±o en problemas de clasificaci√≥n dicot√≥micos (dos clases mutuamente excluyentes) se usa la matriz de confusi√≥n:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>         <span class="o">|</span> <span class="n">Pronostico</span>
         <span class="o">|</span>  <span class="n">P</span>     <span class="n">N</span>
<span class="o">---------|------------</span>
      <span class="n">P</span>  <span class="o">|</span>  <span class="n">TP</span>    <span class="n">FN</span>
<span class="n">Real</span>     <span class="o">|</span>
      <span class="n">N</span>  <span class="o">|</span>  <span class="n">FP</span>    <span class="n">TN</span>

<span class="n">TP</span> <span class="o">-</span> <span class="n">Verdadero</span> <span class="n">positivo</span> <span class="p">(</span><span class="n">correcto</span><span class="p">)</span>
<span class="n">TN</span> <span class="o">-</span> <span class="n">Verdadero</span> <span class="n">negativo</span> <span class="p">(</span><span class="n">correcto</span><span class="p">)</span>
<span class="n">FN</span> <span class="o">-</span> <span class="n">Falso</span> <span class="n">negativo</span> <span class="p">(</span><span class="n">mal</span> <span class="n">clasificado</span><span class="p">)</span>
<span class="n">FP</span> <span class="o">-</span> <span class="n">Falso</span> <span class="n">positivo</span> <span class="p">(</span><span class="n">mal</span> <span class="n">clasificado</span><span class="p">)</span>
</pre></div>
</div>
<p>Esta tabla permite analizar el comportamiento del modelo.</p>
<p>La medici√≥n de la precisi√≥n del modelo permite estimar el desempe√±o del modelo ante nuevos datos.</p>
<ul class="simple">
<li><p>Tasa de √©xito (porcentaje de patrones clasificados correctamente):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{success rate} = \frac{\text{TP} + \text{TN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}}\]</div>
<ul class="simple">
<li><p>Tasa de error (porcentaje total de patrones clasificados incorrectamente):</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{error rate} = \frac{\text{FP} + \text{FN}}{\text{TP} + \text{TN} + \text{FP} + \text{FN}} = 1 - \text{accuracy}\]</div>
<ul class="simple">
<li><p>Precisi√≥n o valor predictivo positivo: Proporci√≥n de casos positivos que fueron verdaderamente positivos.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{precision} = \frac{\text{TP}}{\text{TP}  + \text{FP}}\]</div>
<ul class="simple">
<li><p>Valor predictivo negativo: Proporci√≥n de casos negativos que fueron verdaderamente negativos.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{negative predictive value} = \frac{\text{TN}}{\text{TN}  + \text{FN}}\]</div>
<ul class="simple">
<li><p>Sensibilidad, tasa verdadera positiva, recall: mide la proporci√≥n de ejemplos positivos que fueron correctamente clasificados.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{sensitibity} = \frac{\text{TP}}{\text{TP}  + \text{FN}}\]</div>
<ul class="simple">
<li><p>Especifidad o tasa verdadera negativa: mide la proporci√≥n de ejemplos negativos correctamente clasificados.</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\text{specifity} = \frac{\text{TN}}{\text{TN}  + \text{FP}}\]</div>
<p><strong>Actividad.‚Äî</strong> Para el ejemplo planteado, calcule las m√©tricas de error descritas.</p>
<p><strong>Actividad.‚Äî</strong> Escriba un clasificador de una regla para el siguiente problema y c√≥mpute la matriz de confusi√≥n para el mejor modelo encontrado.</p>
<p><img alt="assets/tree-exercise.jpg" src="../../../_images/tree-exercise.jpg" /></p>
</div>
<div class="section" id="Soluci√≥n-en-Python">
<h2>Soluci√≥n en Python<a class="headerlink" href="#Soluci√≥n-en-Python" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<div class="section" id="Preparaci√≥n-y-carga-de-datos">
<h3>Preparaci√≥n y carga de datos<a class="headerlink" href="#Preparaci√≥n-y-carga-de-datos" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Preparaci√≥n</span>
<span class="c1">##</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">altair</span> <span class="k">as</span> <span class="nn">alt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">load_ext</span> rpy2.ipython
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">##</span>
<span class="c1">## Carga el archivo como un DataFrame</span>
<span class="c1">##</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="s2">&quot;data.csv&quot;</span><span class="p">,</span>
    <span class="n">sep</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span>         <span class="c1"># separador de campos</span>
    <span class="n">thousands</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># separador de miles para n√∫meros</span>
    <span class="n">decimal</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>     <span class="c1"># separador de los decimales para n√∫meros</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>e</td>
      <td>h</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a</td>
      <td>e</td>
      <td>i</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>e</td>
      <td>j</td>
      <td>B</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>f</td>
      <td>h</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>a</td>
      <td>f</td>
      <td>i</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Generaci√≥n-de-las-reglas">
<h3>Generaci√≥n de las reglas<a class="headerlink" href="#Generaci√≥n-de-las-reglas" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">oneR_fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">var</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="c1"># df: pandas DataFrame</span>
    <span class="c1"># var: nombre de la columna para construir el clasificador</span>
    <span class="c1"># target: columna con las clases</span>

    <span class="c1">## crea una copia para no modificar el df original</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1">## Columna para contar la cantidad de ocurrencias del target</span>
    <span class="n">df0</span><span class="p">[</span><span class="s1">&#39;counter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1">## conteo</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">var</span><span class="p">,</span> <span class="n">target</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[[</span><span class="n">var</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="s1">&#39;counter&#39;</span><span class="p">]]</span>

    <span class="c1">## genera un vector con el maximo conteo por cada valor de var</span>
    <span class="n">df0_max_counter</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="n">var</span><span class="p">],</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;counter&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="nb">max</span><span class="p">)</span>

    <span class="c1">## vector de T/F indicando si la fila contiene el valor maximo del conteo</span>
    <span class="n">df0_idx</span> <span class="o">=</span> <span class="n">df0</span><span class="p">[</span><span class="s1">&#39;counter&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">df0_max_counter</span><span class="p">[</span><span class="s1">&#39;counter&#39;</span><span class="p">]</span>

    <span class="c1">## Seleccionar var y target para los maximos</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df0_idx</span><span class="p">,</span> <span class="p">[</span><span class="n">var</span><span class="p">,</span> <span class="n">target</span><span class="p">]]</span>

    <span class="c1">## obtiene solo la primera fila si varias clases</span>
    <span class="c1">## tiene la misma frecuencia maxima</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

    <span class="c1">## convierte var en el indice de la tabla</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">df0</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## reglas para x1</span>
<span class="n">rules_x1</span> <span class="o">=</span> <span class="n">oneR_fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;x1&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">rules_x1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
    </tr>
    <tr>
      <th>x1</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>A</td>
    </tr>
    <tr>
      <th>b</th>
      <td>B</td>
    </tr>
    <tr>
      <th>c</th>
      <td>C</td>
    </tr>
    <tr>
      <th>d</th>
      <td>A</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## reglas para x2</span>
<span class="n">rules_x2</span> <span class="o">=</span> <span class="n">oneR_fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;x2&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">rules_x2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
    </tr>
    <tr>
      <th>x2</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>e</th>
      <td>B</td>
    </tr>
    <tr>
      <th>f</th>
      <td>A</td>
    </tr>
    <tr>
      <th>g</th>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## reglas para x3</span>
<span class="n">rules_x3</span> <span class="o">=</span> <span class="n">oneR_fit</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;x3&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">rules_x3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y</th>
    </tr>
    <tr>
      <th>x3</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>h</th>
      <td>A</td>
    </tr>
    <tr>
      <th>i</th>
      <td>B</td>
    </tr>
    <tr>
      <th>j</th>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Predicci√≥n">
<h3>Predicci√≥n<a class="headerlink" href="#Predicci√≥n" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">oneR_predict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rules</span><span class="p">):</span>
    <span class="c1">## genera una copia del DataFrame</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1">##¬†convierte la variable usada para construir las reglas</span>
    <span class="c1">## en el indice de las filas del dataframe</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">rules</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">## hace un left join con base en los valores de los</span>
    <span class="c1">## indices de las filas del df y rules</span>
    <span class="n">df0</span> <span class="o">=</span> <span class="n">df0</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">rules</span><span class="p">,</span> <span class="n">rsuffix</span><span class="o">=</span><span class="s1">&#39;_predicted_&#39;</span> <span class="o">+</span> <span class="n">rules</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">df0</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df0</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">df0</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df0</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df0</span> <span class="o">=</span> <span class="n">oneR_predict</span><span class="p">(</span><span class="n">df0</span><span class="p">,</span> <span class="n">rules_x1</span><span class="p">)</span>  <span class="c1">## Pronostico usando x1</span>
<span class="n">df0</span> <span class="o">=</span> <span class="n">oneR_predict</span><span class="p">(</span><span class="n">df0</span><span class="p">,</span> <span class="n">rules_x2</span><span class="p">)</span>  <span class="c1">## Pronostico usando x2</span>
<span class="n">df0</span> <span class="o">=</span> <span class="n">oneR_predict</span><span class="p">(</span><span class="n">df0</span><span class="p">,</span> <span class="n">rules_x3</span><span class="p">)</span>  <span class="c1">## Pronostico usando x3</span>
<span class="n">df0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x1</th>
      <th>x2</th>
      <th>x3</th>
      <th>y</th>
      <th>y_predicted_x1</th>
      <th>y_predicted_x2</th>
      <th>y_predicted_x3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>a</td>
      <td>e</td>
      <td>h</td>
      <td>A</td>
      <td>A</td>
      <td>B</td>
      <td>A</td>
    </tr>
    <tr>
      <th>1</th>
      <td>a</td>
      <td>f</td>
      <td>h</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
    </tr>
    <tr>
      <th>2</th>
      <td>a</td>
      <td>g</td>
      <td>h</td>
      <td>A</td>
      <td>A</td>
      <td>B</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>a</td>
      <td>g</td>
      <td>h</td>
      <td>B</td>
      <td>A</td>
      <td>B</td>
      <td>A</td>
    </tr>
    <tr>
      <th>4</th>
      <td>c</td>
      <td>g</td>
      <td>h</td>
      <td>B</td>
      <td>C</td>
      <td>B</td>
      <td>A</td>
    </tr>
    <tr>
      <th>5</th>
      <td>a</td>
      <td>e</td>
      <td>i</td>
      <td>C</td>
      <td>A</td>
      <td>B</td>
      <td>B</td>
    </tr>
    <tr>
      <th>6</th>
      <td>b</td>
      <td>e</td>
      <td>i</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
      <td>B</td>
    </tr>
    <tr>
      <th>7</th>
      <td>c</td>
      <td>e</td>
      <td>i</td>
      <td>C</td>
      <td>C</td>
      <td>B</td>
      <td>B</td>
    </tr>
    <tr>
      <th>8</th>
      <td>a</td>
      <td>f</td>
      <td>i</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>B</td>
    </tr>
    <tr>
      <th>9</th>
      <td>b</td>
      <td>f</td>
      <td>i</td>
      <td>B</td>
      <td>B</td>
      <td>A</td>
      <td>B</td>
    </tr>
    <tr>
      <th>10</th>
      <td>c</td>
      <td>g</td>
      <td>i</td>
      <td>B</td>
      <td>C</td>
      <td>B</td>
      <td>B</td>
    </tr>
    <tr>
      <th>11</th>
      <td>a</td>
      <td>e</td>
      <td>j</td>
      <td>B</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
    </tr>
    <tr>
      <th>12</th>
      <td>b</td>
      <td>f</td>
      <td>j</td>
      <td>B</td>
      <td>B</td>
      <td>A</td>
      <td>C</td>
    </tr>
    <tr>
      <th>13</th>
      <td>c</td>
      <td>f</td>
      <td>j</td>
      <td>C</td>
      <td>C</td>
      <td>A</td>
      <td>C</td>
    </tr>
    <tr>
      <th>14</th>
      <td>d</td>
      <td>f</td>
      <td>j</td>
      <td>A</td>
      <td>A</td>
      <td>A</td>
      <td>C</td>
    </tr>
    <tr>
      <th>15</th>
      <td>b</td>
      <td>g</td>
      <td>j</td>
      <td>C</td>
      <td>B</td>
      <td>B</td>
      <td>C</td>
    </tr>
    <tr>
      <th>16</th>
      <td>c</td>
      <td>g</td>
      <td>j</td>
      <td>C</td>
      <td>C</td>
      <td>B</td>
      <td>C</td>
    </tr>
    <tr>
      <th>17</th>
      <td>d</td>
      <td>g</td>
      <td>j</td>
      <td>A</td>
      <td>A</td>
      <td>B</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="Precisi√≥n">
<h3>Precisi√≥n<a class="headerlink" href="#Precisi√≥n" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## cantidad de aciertos</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x1 : &#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">df0</span><span class="o">.</span><span class="n">y_predicted_x1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x2 : &#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">df0</span><span class="o">.</span><span class="n">y_predicted_x2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x3 : &#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">df0</span><span class="o">.</span><span class="n">y_predicted_x3</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
x1 :  12
x2 :  8
x3 :  9
</pre></div></div>
</div>
</div>
<div class="section" id="Matriz-de-confusi√≥n">
<h3>Matriz de confusi√≥n<a class="headerlink" href="#Matriz-de-confusi√≥n" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">df0</span><span class="o">.</span><span class="n">y_predicted_x1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[6, 0, 0],
       [2, 3, 2],
       [1, 1, 3]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">df0</span><span class="o">.</span><span class="n">y_predicted_x2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[3, 3, 0],
       [2, 5, 0],
       [1, 4, 0]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">df0</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">df0</span><span class="o">.</span><span class="n">y_predicted_x3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[3, 1, 2],
       [2, 3, 2],
       [0, 2, 3]])
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Soluci√≥n-usando-el-lenguaje-R">
<h2>Soluci√≥n usando el lenguaje R<a class="headerlink" href="#Soluci√≥n-usando-el-lenguaje-R" title="Enlazar permanentemente con este t√≠tulo">¬∂</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span> <span class="o">-</span><span class="n">i</span> <span class="n">df</span>
<span class="c1">##</span>
<span class="c1">## Instalaci√≥n del paquete:</span>
<span class="c1">##</span>
<span class="c1">##       install.packages(&quot;OneR&quot;)</span>
<span class="c1">##</span>

<span class="c1">##</span>
<span class="c1">## Carga la librer√≠a.</span>
<span class="c1">##</span>
<span class="nf">library</span><span class="p">(</span><span class="n">OneR</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## Crea el clasificador. La librer√≠a reporta la precisi√≥n</span>
<span class="c1">## del clasificador si se usa cada uno de los atributos</span>
<span class="c1">## (variables x) y el sistema de reglas obtenido.</span>
<span class="c1">## La notaci√≥n y ~ . indica que la variable y del dataframe es funci√≥n de las restantes</span>
<span class="c1">##</span>
<span class="n">clf</span> <span class="o">&lt;-</span> <span class="nf">OneR</span><span class="p">(</span><span class="n">y</span> <span class="o">~</span> <span class="n">.,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>

<span class="c1">##</span>
<span class="c1">## la salida del modelo indica la tasa de √©xito para los clasificadores de todas las clases</span>
<span class="c1">## Igualmente se imprimen las reglas de decisi√≥n para el mejor clasificador</span>
<span class="c1">##</span>
<span class="n">clf</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

    Attribute Accuracy
1 * x1        66.67%
2   x3        50%
3   x2        44.44%
---
Chosen attribute due to accuracy
and ties method (if applicable): &#39;*&#39;


Call:
OneR.formula(formula = y ~ ., data = df, verbose = TRUE)

Rules:
If x1 = a then y = A
If x1 = b then y = B
If x1 = c then y = C
If x1 = d then y = A

Accuracy:
12 of 18 instances classified correctly (66.67%)

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="c1">##</span>
<span class="c1">## La funci√≥n summary reporta informaci√≥n detallada</span>
<span class="c1">## de los resultados del modelo, junto con la matriz</span>
<span class="c1">## de confusi√≥n</span>
<span class="c1">##</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

Call:
OneR.formula(formula = y ~ ., data = df, verbose = TRUE)

Rules:
If x1 = a then y = A
If x1 = b then y = B
If x1 = c then y = C
If x1 = d then y = A

Accuracy:
12 of 18 instances classified correctly (66.67%)

Contingency table:
     x1
y       a   b   c   d Sum
  A   * 4   0   0 * 2   6
  B     2 * 3   2   0   7
  C     1   1 * 3   0   5
  Sum   7   4   5   2  18
---
Maximum in each column: &#39;*&#39;

Pearson&#39;s Chi-squared test:
X-squared = 12.064, df = 6, p-value = 0.06056

</pre></div></div>
</div>
<p><strong>Matriz de confusi√≥n</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-r notranslate"><div class="highlight"><pre>
<span></span><span class="o">%%</span><span class="n">R</span>
<span class="nf">library</span><span class="p">(</span><span class="n">gmodels</span><span class="p">)</span>
<span class="nf">CrossTable</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="o">$</span><span class="n">y</span><span class="p">,</span>
           <span class="n">y</span> <span class="o">=</span> <span class="nf">predict</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span><span class="n">df</span><span class="p">),</span>
           <span class="n">prop.chisq</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


   Cell Contents
|-------------------------|
|                       N |
|           N / Row Total |
|           N / Col Total |
|         N / Table Total |
|-------------------------|


Total Observations in Table:  18


             | predict(clf, df)
        df$y |         A |         B |         C | Row Total |
-------------|-----------|-----------|-----------|-----------|
           A |         6 |         0 |         0 |         6 |
             |     1.000 |     0.000 |     0.000 |     0.333 |
             |     0.667 |     0.000 |     0.000 |           |
             |     0.333 |     0.000 |     0.000 |           |
-------------|-----------|-----------|-----------|-----------|
           B |         2 |         3 |         2 |         7 |
             |     0.286 |     0.429 |     0.286 |     0.389 |
             |     0.222 |     0.750 |     0.400 |           |
             |     0.111 |     0.167 |     0.111 |           |
-------------|-----------|-----------|-----------|-----------|
           C |         1 |         1 |         3 |         5 |
             |     0.200 |     0.200 |     0.600 |     0.278 |
             |     0.111 |     0.250 |     0.600 |           |
             |     0.056 |     0.056 |     0.167 |           |
-------------|-----------|-----------|-----------|-----------|
Column Total |         9 |         4 |         5 |        18 |
             |     0.500 |     0.222 |     0.278 |           |
-------------|-----------|-----------|-----------|-----------|


</pre></div></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Juan D. Velasquez

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>