<!DOCTYPE html>
<html class="writer-html5" lang="es" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adaptive Linear Neuron (ADALINEs) — 49:55 min &mdash; documentación de Cursos de Analítica y Machine Learning - </title><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
        <script src="../../_static/clipboard.min.js"></script>
        <script src="../../_static/copybutton.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="Pronóstico de la cantidad de usuarios que acceden a un servidor de internet usando un ADALINE — 20:16 min" href="1-02-pronostico-airline.html" />
    <link rel="prev" title="Gradiente Descendente Estocástico para Clasificación — 11:53 min" href="../sklearn_supervised_04_sdg/1-02-SGD_classifier.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Cursos de Analítica y Machine Learning
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Configuración</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Instalación de Vagrant y Docker</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Pregrado</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-01-2022-mar-08">Sesión 01 — 2022-mar-08</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-02-2022-mar-14">Sesión 02 — 2022-mar-14</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-03-2022-mar-22">Sesión 03 — 2022-mar-22</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-04-2022-mar-29">Sesión 04 — 2022-mar-29</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-05-2022-abr-05">Sesión 05 — 2022-abr-05</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-06-2022-abr-19">Sesión 06 — 2022-abr-19</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-07-2022-abr-26">Sesión 07 — 2022-abr-26,</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-08-2022-may-03">Sesión 08 — 2022-may-03</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-09-2022-may-10">Sesión 09 — 2022-may-10</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-10-2022-may-17">Sesión 10 — 2022-may-17</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-11-2022-may-24">Sesión 11 — 2022-may-24</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-12-2022-may-31">Sesión 12 — 2022-may-31</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-13-2022-jun-07">Sesión 13 — 2022-jun-07</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-14-2022-jun-14">Sesión 14 — 2022-jun-14</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-15-2022-jun-21">Sesión 15 — 2022-jun-21</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#sesion-16-2022-jun-28">Sesión 16 — 2022-jun-28</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html#material-para-proximos-cursos-2023">Material para próximos cursos (2023)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../fundamentos_de_analitica/index.html">Fundamentos de Analítica</a></li>
</ul>
<p class="caption"><span class="caption-text">Cursos de Posgrado</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_de_grandes_datos/index.html">Analítica de Grandes Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_predictiva/index.html">Analítica Predictiva</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ciencia_de_los_datos/index.html">Ciencia de los Datos Aplicada</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../productos_de_datos/index.html">Productos de Datos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analitica_avanzada/index.html">Analítica Avanzada</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cursos de Analítica y Machine Learning</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../redes_neuronales_y_algoritmos_bioinspirados/index.html">Redes Neuronales Artificiales y Aprendizaje Profundo</a> &raquo;</li>
      <li>Adaptive Linear Neuron (ADALINEs) — 49:55 min</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/notebooks/adaptive_linear_combiner/1-01_adaline_teoria.ipynb.txt" rel="nofollow"> Ver código fuente de la página</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Adaptive-Linear-Neuron-(ADALINEs)-—-49:55-min">
<h1>Adaptive Linear Neuron (ADALINEs) — 49:55 min<a class="headerlink" href="#Adaptive-Linear-Neuron-(ADALINEs)-—-49:55-min" title="Enlazar permanentemente con este título"></a></h1>
<ul class="simple">
<li><p>Última modificación: Abril 19, 2021 | <a class="reference external" href="https://youtu.be/TxtH3HU8kco">YouTube</a></p></li>
</ul>
<p>Los combinadores lineales adaptativos o ADALINEs son modelos que se obtienen al considerar la entrada neta en un perceptrón bipolar simple y corresponden a un modelo lineal. En esta lección, se aborda este tipo de modelo y se presenta su algoritmo de entrenamiento. Su ventaja está en que el algoritmo de aprendizaje se aplica directamente sobre la salida del combinador lineal y no sobre la salida del perceptrón lo que facilita su entrenamiento, lo que permite la formulación de un esquema de
aprendizaje adaptativo para sistemas cuya dinámica cambia en el tiempo.</p>
<div class="section" id="Perceptrón-bipolar-con-entradas-y-pesos-reales">
<h2>Perceptrón bipolar con entradas y pesos reales<a class="headerlink" href="#Perceptrón-bipolar-con-entradas-y-pesos-reales" title="Enlazar permanentemente con este título"></a></h2>
<p>El modelo que se presenta a continuación representa un perceptrón bipolar (con salida <span class="math notranslate nohighlight">\(\in \{-1, +1\}\)</span>) con entradas y pesos reales:</p>
<p><img alt="assets/AdalinePronostico-02.png" src="../../_images/AdalinePronostico-02.png" /></p>
<p>La entrada neta se calcula como:</p>
<div class="math notranslate nohighlight">
\[v = w_0 + \sum_{i=1}^n w_i x_i\]</div>
<p>La cual puede ser reescrita usando notación matricial al hacer</p>
<div class="math notranslate nohighlight">
\[\mathbf{w} = [w_0, w_1, ..., w_n]^T\]</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[\mathbf{x} = [+1, x_1, x_2, ..., x_n]^T\]</div>
<p>tal que:</p>
<div class="math notranslate nohighlight">
\[v = \mathbf{w}^T \mathbf{x}\]</div>
<p>La regla de activación es:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\varphi(v) =
\begin{cases}
      +1, &amp; \text{Si $v \ge 0$}\\
      -1, &amp; \text{Si $v \lt 0$}\\
\end{cases}\end{split}\]</div>
<p>Este tipo de perceptrón puede ser utilizado para representar funciones lógicas bipolares:</p>
<p><img alt="assets/AdalinePronostico-03.png" src="../../_images/AdalinePronostico-03.png" /></p>
<p><strong>Actividad.—</strong> Especifique pesos que permitan representar las siguientes funciones:</p>
<p><img alt="assets/AdalinePronostico-04.png" src="../../_images/AdalinePronostico-04.png" /></p>
</div>
<div class="section" id="Combinador-lineal-adaptativo">
<h2>Combinador lineal adaptativo<a class="headerlink" href="#Combinador-lineal-adaptativo" title="Enlazar permanentemente con este título"></a></h2>
<p>La primera parte del perceptrón bipolar corresponde a un combinador lineal adaptativo (ADALINE), mientras que la función de activación es un conmutador bipolar.</p>
<p><img alt="assets/AdalinePronostico-05.png" src="../../_images/AdalinePronostico-05.png" /></p>
<p>De esta forma, la salida del combinador lineal adaptativo o ADALINE es:</p>
<div class="math notranslate nohighlight">
\[v=w_0 + \sum_i w_i x_i\]</div>
<p>## Estimación de los parámetros del modelo</p>
<p>El combinador lineal adaptativo puede:</p>
<ul class="simple">
<li><p>Adaptarse automáticamente a ambientes dinámicos (¿auto-optimización?).</p></li>
<li><p>Realizar tareas de filtrado, pronóstico y toma de decisiones .</p></li>
<li><p>Eextrapolar el comportamiento de un sistema con el fin de manejar nuevas situaciones.</p></li>
<li><p>Reproducir el comportamiento de sistemas no lineales con parámetros cambiantes en el tiempo.</p></li>
</ul>
<p>Un ADALINE es un sistema adaptativo de lazo cerrado. En los sistemas de lazo cerrado:</p>
<ul class="simple">
<li><p>Se conocen las variables de entrada al sistema o <span class="math notranslate nohighlight">\(x_k\)</span>.</p></li>
<li><p>El modelo adaptativo (un ADALINE en este caso) es usado para realizar un pronóstico del resultado del sistema (<span class="math notranslate nohighlight">\(v\)</span>).</p></li>
<li><p>Posteriormente, se conoce la salida del sistema o variable dependiente (<span class="math notranslate nohighlight">\(d\)</span>).</p></li>
<li><p>Los parámetros del sistema adaptativo son ajustados a partir de los valores de <span class="math notranslate nohighlight">\(v\)</span> y <span class="math notranslate nohighlight">\(d\)</span>.</p></li>
</ul>
<p>En el caso del problema planteado, el pronóstico se realiza usando el siguiente sistema adaptativo de lazo cerrado, en el cual, el modelo adaptativo es un ADALINE.</p>
<p><img alt="assets/AdalinePronostico-06.png" src="../../_images/AdalinePronostico-06.png" /></p>
</div>
<div class="section" id="Algoritmo-\mu-LMS-o-gradiente-descendente">
<h2>Algoritmo <span class="math notranslate nohighlight">\(\mu\)</span>-LMS o gradiente descendente<a class="headerlink" href="#Algoritmo-\mu-LMS-o-gradiente-descendente" title="Enlazar permanentemente con este título"></a></h2>
<p>A partir de este punto la salida del combinador lineal adaptativo se notará como <span class="math notranslate nohighlight">\(y\)</span> para mantener la consistencia con otros tutoriales.</p>
<p>Se obtiene al aplicar el algoritmo del gradiente descendente para minimizar el error cuadrático instántaneo:</p>
<div class="math notranslate nohighlight">
\[e^2 = (d - y)^2\]</div>
<p>con:</p>
<div class="math notranslate nohighlight">
\[y = w_0 + \sum_i w_i x_i\]</div>
<p>entonces:</p>
<div class="math notranslate nohighlight">
\[e^2 = (d - w_0  - \sum_i w_i x_i)^2\]</div>
<p>Para encontrar el valor óptimo de los parámetros <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> se usa el gradiente descendente:</p>
<div class="math notranslate nohighlight">
\[\mathbf{w}_{k+1} = \mathbf{w}_{k} - \mu \frac{\partial}{\partial \mathbf{w}} e_k^2\]</div>
<p>Las derivadas del error instantaneo son:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\frac{\partial}{\partial w_0} e^2
    &amp; = \frac{\partial}{\partial w_0}  (d - w_0  - \sum_i w_i x_i)^2 \\ \\
    &amp; = 2 \cdot (d - w_0  - \sum_i w_i x_i) \cdot \frac{\partial}{\partial w_0} (d - w_0  - \sum_i w_i x_i) \\ \\
    &amp; = 2 \cdot (d - w_0  - \sum_i w_i x_i) \cdot (-1) \\ \\
    &amp; = -2 \cdot e
\end{split}\end{split}\]</div>
<p>y</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
\frac{\partial}{\partial w_i} e^2
    &amp; = \frac{\partial}{\partial w_i}  (d - w_0  - \sum_i w_i x_i)^2 \\ \\
    &amp; = 2 \cdot (d - w_0  - \sum_i w_i x_i) \cdot \frac{\partial}{\partial w_i} (d - w_0  - \sum_i w_i x_i) \\ \\
    &amp; = 2 \cdot (d - w_0  - \sum_i w_i x_i) \cdot (-x_i) \\ \\
    &amp; = -2 \cdot e \cdot x_i
\end{split}\end{split}\]</div>
<p>De esta forma, la ecuación del gradiente descendente pueden escribirse como:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
w_0^{(k+1)}
    &amp; = w_0^{(k)} - \mu \cdot \frac{\partial}{\partial w_0} (e^{(k)})^2  \\ \\
    &amp; = w_0^{(k)} - \mu \cdot (-2e^{(k)}) \\ \\
    &amp; = w_0^{(k)} + 2 \mu e^{(k)}
\end{split}\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{split}
w_i^{(k+1)}
    &amp; = w_i^{(k)} - \mu \cdot \frac{\partial}{\partial w_0} (e^{(k)})^2  \\ \\
    &amp; = w_i^{(k)} - \mu \cdot (-2 \cdot e^{(k)} \cdot x_i) \\ \\
    &amp; = w_i^{(k)} + 2 \mu e^{(k)} x_i
\end{split}\end{split}\]</div>
<p>Note que las ecuaciones anteriores corresponden al esquema de <em>aprendizaje online</em> por lo que puede usarse el gradiente descendente estocástico.</p>
<p>Se ha encontrado que el algoritimo converge si:</p>
<div class="math notranslate nohighlight">
\[0 &lt; \mu &lt; \frac{1}{1 + \sum_{i=0}^n E[x_i^2]}\]</div>
</div>
<div class="section" id="Implementación">
<h2>Implementación<a class="headerlink" href="#Implementación" title="Enlazar permanentemente con este título"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">class</span> <span class="nc">Adaline</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="c1"># tasa de aprendizaje</span>
        <span class="n">max_epochs</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>      <span class="c1"># número máximo de iteraciones sobre el set de datos</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>       <span class="c1"># mezcla patrones para aprendizaje online</span>
        <span class="n">random_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>   <span class="c1">#</span>
        <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>    <span class="c1">#</span>
    <span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_epochs</span> <span class="o">=</span> <span class="n">max_epochs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span> <span class="o">=</span> <span class="n">shuffle</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="o">=</span> <span class="n">random_state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="o">=</span> <span class="n">warm_start</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_state</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">warm_start</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">errors2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">forecasts</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_epochs</span><span class="p">):</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffle</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">n</span><span class="p">,</span> <span class="p">:]</span>
                <span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span>
                <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">u</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">e</span> <span class="o">*</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">*</span> <span class="n">e</span>
                <span class="n">errors2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
                <span class="n">forecasts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">errors2</span><span class="p">,</span> <span class="n">forecasts</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">intercept_</span>
        <span class="k">return</span> <span class="n">u</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Caso-de-aplicación-—-Pronóstico-adaptativo">
<h2>Caso de aplicación — Pronóstico adaptativo<a class="headerlink" href="#Caso-de-aplicación-—-Pronóstico-adaptativo" title="Enlazar permanentemente con este título"></a></h2>
<div class="section" id="Definición-del-problema">
<h3>Definición del problema<a class="headerlink" href="#Definición-del-problema" title="Enlazar permanentemente con este título"></a></h3>
<p>Hay un sistema que emite una señal contaminada con ruído de forma continua. Ejemplos de este tipo de señal pueden ser:</p>
<ul class="simple">
<li><p>Los precios de un producto en un mercado.</p></li>
<li><p>Una tasa de cambio.</p></li>
<li><p>La demanda de un producto.</p></li>
<li><p>La salida de un sensor en una máquina.</p></li>
</ul>
<p>Para la toma de decisiones se desea obtener pronósticos de sus valores futuros a partir de los valores pasados de la señal.</p>
<p>En este tipo de problemas no es posible modelar el sistema que genera la señal de salida <span class="math notranslate nohighlight">\(d(t)\)</span>. Adicionalmente, la señal está contaminada con ruído por lo que resulta imposible pronosticarla de forma perfecta. Se requiere un sistema que pronostique el valor actual de la señal, <span class="math notranslate nohighlight">\(d_t\)</span>, con base en sus valores pasados <span class="math notranslate nohighlight">\(d_{t-1}\)</span>, <span class="math notranslate nohighlight">\(d_{t-2}\)</span>, …</p>
</div>
<div class="section" id="Dataset">
<h3>Dataset<a class="headerlink" href="#Dataset" title="Enlazar permanentemente con este título"></a></h3>
<p>Para facilitar el problema, a continuación se genera una señal <span class="math notranslate nohighlight">\(d_t\)</span> que cambia de amplitud y de periodo cada cierto tiempo.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">8</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)]</span>
<span class="n">d</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">134</span><span class="p">)]</span>
<span class="n">d</span> <span class="o">+=</span> <span class="p">[</span><span class="mf">0.8</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">134</span><span class="p">,</span> <span class="mi">250</span><span class="p">)]</span>
<span class="n">d</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.06</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_46_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_46_0.png" />
</div>
</div>
</div>
<div class="section" id="Preparación-de-datos">
<h3>Preparación de datos<a class="headerlink" href="#Preparación-de-datos" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Para pronosticar el valor actual se toman los `L`</span>
<span class="c1">#  valores previos de la serie</span>
<span class="c1">#</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1">#</span>
<span class="c1"># Forma la matriz X</span>
<span class="c1">#</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="n">L</span> <span class="p">:</span> <span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="c1">#</span>
<span class="c1"># Primeras 3 filas</span>
<span class="c1">#</span>
<span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[-0.012282459569082776,
  0.41142003264854266,
  0.6759404582831432,
  0.8905357142504373,
  1.1179468343501628],
 [0.41142003264854266,
  0.6759404582831432,
  0.8905357142504373,
  1.1179468343501628,
  1.0074838824896661],
 [0.6759404582831432,
  0.8905357142504373,
  1.1179468343501628,
  1.0074838824896661,
  0.7126812537911706]]
</pre></div></div>
</div>
</div>
<div class="section" id="Modelo">
<h3>Modelo<a class="headerlink" href="#Modelo" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">adaline</span> <span class="o">=</span> <span class="n">Adaline</span><span class="p">(</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># tasa de aprendizaje</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>  <span class="c1"># número máximo de iteraciones sobre el set de datos</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># mezcla patrones para aprendizaje online</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>  <span class="c1"># corrida reproducible</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>  <span class="c1"># inicia con pesos aleatorios</span>
<span class="p">)</span>

<span class="n">errors2</span><span class="p">,</span> <span class="n">forecasts</span> <span class="o">=</span> <span class="n">adaline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span>
    <span class="n">d</span><span class="p">[</span><span class="n">L</span><span class="p">:],</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Pronóstico</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">forecasts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_50_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_50_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Errores</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">errors2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_51_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_51_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Caso-de-aplicación-—-Identificación-de-sistemas">
<h2>Caso de aplicación — Identificación de sistemas<a class="headerlink" href="#Caso-de-aplicación-—-Identificación-de-sistemas" title="Enlazar permanentemente con este título"></a></h2>
<div class="section" id="id1">
<h3>Definición del problema<a class="headerlink" href="#id1" title="Enlazar permanentemente con este título"></a></h3>
<p>Cuando un sistema desconocido es excitado mediante una señal de entrada <span class="math notranslate nohighlight">\(z(k)\)</span> se produce una señal de salida <span class="math notranslate nohighlight">\(d(k)\)</span>. El diagrama del sistema aparece en la figura de abajo. Para efectos de control se requiere un modelo que permita pronosticar el valor de <span class="math notranslate nohighlight">\(d(k)\)</span> a partir del valor actual y los valores pasados de la señal de entrada <span class="math notranslate nohighlight">\(z(k)\)</span>, <span class="math notranslate nohighlight">\(z(k-1)\)</span>, <span class="math notranslate nohighlight">\(z(k-2)\)</span>, … El diagrama ilustrativo es presentado a continuación.</p>
<p><img alt="assets/AdalineIdentificacion-01.png" src="../../_images/AdalineIdentificacion-01.png" /></p>
<p>En este tipo de problemas no es posible modelar el sistema que genera la señal de salida <span class="math notranslate nohighlight">\(d(t)\)</span>. Adicionalmente, la señal está contaminada con ruído por lo que resulta imposible pronosticarla de forma perfecta. Por facilidad se supondra que la dinámica del sistema desconocido es descrita por siguiente ecuación no lineal:</p>
<div class="math notranslate nohighlight">
\[d_t = 0.4 + 0.1 z_{t} + 0.9 z_{t-1} - 0.6 z_{t-2} - 0.2 z_{t-1}^2 + u_t\]</div>
<p>donde <span class="math notranslate nohighlight">\(u_t\)</span> es una variable aleatoria normal con <span class="math notranslate nohighlight">\(\mu=0\)</span> y <span class="math notranslate nohighlight">\(\sigma = 0.05\)</span>. <span class="math notranslate nohighlight">\(z_t\)</span> es una variable aleatoria uniforme en el intervalo <span class="math notranslate nohighlight">\([0,1]\)</span>. A continuación se generan las series.</p>
<p>El problema propuesto es conocido como un problema de identificación de sistemas, donde un modelo adaptativo (una red neuronal en este caso) debe aproximar el comportamiento real (la salida, <span class="math notranslate nohighlight">\(d_t\)</span>) de un sistema desconocido a partir de un conjunto de entradas (el vector <span class="math notranslate nohighlight">\(\mathbf{x}_t\)</span>) conocidas. El diagrama esquemático del sistema es el siguiente:</p>
<p><img alt="assets/AdalineIdentificacion-02.png" src="../../_images/AdalineIdentificacion-02.png" /></p>
</div>
<div class="section" id="id2">
<h3>Dataset<a class="headerlink" href="#id2" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">12345</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">303</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">0.05</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">303</span><span class="p">)</span>

<span class="n">L</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">303</span><span class="p">):</span>
    <span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">d</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.4</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">303</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">303</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;z (entrada)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;d (salida)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_59_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_59_0.png" />
</div>
</div>
<p>En términos de los datos se requiere construir un modelo de regresión que permita pronosticar <span class="math notranslate nohighlight">\(d_t\)</span> a partir de los valores <span class="math notranslate nohighlight">\(z_t\)</span>, <span class="math notranslate nohighlight">\(z_{t-1}\)</span>, …</p>
</div>
<div class="section" id="id3">
<h3>Preparación de datos<a class="headerlink" href="#id3" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1">#  Para pronosticar el valor actual se toman los `L`</span>
<span class="c1">#  valores previos de la serie explicativa</span>
<span class="c1">#</span>
<span class="n">L</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1">#</span>
<span class="c1"># Forma la matriz X</span>
<span class="c1">#</span>
<span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)):</span>
    <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">t</span> <span class="o">-</span> <span class="n">L</span> <span class="p">:</span> <span class="n">t</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1">#</span>
<span class="c1"># Primeras 3 filas</span>
<span class="c1">#</span>
<span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[[0.2045602785530397,
  0.5677250290816866,
  0.5955447029792516,
  0.9645145197356216,
  0.6531770968715709],
 [0.5677250290816866,
  0.5955447029792516,
  0.9645145197356216,
  0.6531770968715709,
  0.7489066375339118],
 [0.5955447029792516,
  0.9645145197356216,
  0.6531770968715709,
  0.7489066375339118,
  0.6535698708517353]]
</pre></div></div>
</div>
</div>
<div class="section" id="id4">
<h3>Modelo<a class="headerlink" href="#id4" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Especificación</span>
<span class="c1">#</span>
<span class="n">adaline</span> <span class="o">=</span> <span class="n">Adaline</span><span class="p">(</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span>  <span class="c1"># tasa de aprendizaje</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>        <span class="c1"># número máximo de iteraciones sobre el set de datos</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>       <span class="c1"># mezcla patrones para aprendizaje online</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>    <span class="c1"># corrida reproducible</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>    <span class="c1"># pesos iniciales aleatorios</span>
<span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># Entrenamiento</span>
<span class="c1">#</span>
<span class="n">errors2</span><span class="p">,</span> <span class="n">forecasts</span> <span class="o">=</span> <span class="n">adaline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">d</span><span class="p">[</span><span class="n">L</span><span class="p">:])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)),</span> <span class="n">forecasts</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_64_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_64_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Errores</span>
<span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">errors2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_65_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_65_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="Caso-de-aplicación-—-Clasificación">
<h2>Caso de aplicación — Clasificación<a class="headerlink" href="#Caso-de-aplicación-—-Clasificación" title="Enlazar permanentemente con este título"></a></h2>
<div class="section" id="id5">
<h3>Definición del problema<a class="headerlink" href="#id5" title="Enlazar permanentemente con este título"></a></h3>
<p>El problema de clasificación binaria (con clases <span class="math notranslate nohighlight">\(C_1\)</span> y <span class="math notranslate nohighlight">\(C_2\)</span> dicotómicas) se define de la siguiente manera:</p>
<ul class="simple">
<li><p>Cada patrón de entrada tiene la forma <span class="math notranslate nohighlight">\(\mathbf{x}=[+1,x_1,x_2,…,x_n ]\)</span>.</p></li>
<li><p>Los parámetros del ADALINE son <span class="math notranslate nohighlight">\(\mathbf{w}=[w_0,w_1,…,w_n]\)</span> tal que <span class="math notranslate nohighlight">\(y=\varphi(\mathbf{w}^T \mathbf{x})\)</span>.</p></li>
<li><p>Se desea encontrar el vector <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> tal que el ADALINE clasifique correctamente todos los patrones de entrenamiento.</p></li>
<li><p>El error del ADALINE con parámetros <span class="math notranslate nohighlight">\(\mathbf{w}\)</span>, <span class="math notranslate nohighlight">\(E(\mathbf{w})\)</span>, es la cantidad de patrones mal clasificados.</p></li>
</ul>
<p>El siguiente diagrama representa como sería solucionado el problema mediante un perceptrón binario. Si la salida del perceptrón es <span class="math notranslate nohighlight">\(+1\)</span>, la correspondiente entrada <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> es clasificada en la clase <span class="math notranslate nohighlight">\(C_2\)</span>, y si la salida es <span class="math notranslate nohighlight">\(-1\)</span> la entrada es clasificada en la clase <span class="math notranslate nohighlight">\(C_1\)</span>.</p>
<p><img alt="../assets/AdalineClasificacion-01.png" src="../../_images/AdalineClasificacion-01.png" /></p>
<p>La frontera de decisión se obtiene al hacer cero la entrada al ADALINE:</p>
<div class="math notranslate nohighlight">
\[v=w_0+\sum_{i=}^n w_i x_i =0\]</div>
<ul class="simple">
<li><p>La frontera de decisión es ortogonal al vector de pesos.</p></li>
<li><p>Se puede suponer un vector direccional y luego despejar el intercepto.</p></li>
<li><p>Para redes de neuronas ADALINE (MADALINE), cada neurona de salida tiene su propia frontera de decisión.</p></li>
</ul>
<p>A continuación se presenta la frontera de decisión generada por un ADALINE para la función lógica AND:</p>
<p><img alt="../assets/AdalineClasificacion-02.png" src="../../_images/AdalineClasificacion-02.png" /></p>
</div>
<div class="section" id="id6">
<h3>Dataset<a class="headerlink" href="#id6" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_blobs</span>

<span class="n">NPOINTS</span> <span class="o">=</span> <span class="mi">150</span>

<span class="n">X</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="n">make_blobs</span><span class="p">(</span>
    <span class="n">n_samples</span><span class="o">=</span><span class="n">NPOINTS</span><span class="p">,</span>
    <span class="n">n_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">centers</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">cluster_std</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">100</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">100</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_71_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_71_0.png" />
</div>
</div>
</div>
<div class="section" id="Modelos">
<h3>Modelos<a class="headerlink" href="#Modelos" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">adaline_A</span> <span class="o">=</span> <span class="n">Adaline</span><span class="p">(</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">,</span>  <span class="c1"># tasa de aprendizaje</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># número máximo de iteraciones sobre el set de datos</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># mezcla patrones para aprendizaje online</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>  <span class="c1"># corrida reproducible</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># inicia con pesos aleatorios</span>

<span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

<span class="n">errors2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">adaline_A</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">A</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">errors2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_73_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_73_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">adaline_B</span> <span class="o">=</span> <span class="n">Adaline</span><span class="p">(</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">,</span>  <span class="c1"># tasa de aprendizaje</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># número máximo de iteraciones sobre el set de datos</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># mezcla patrones para aprendizaje online</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>  <span class="c1"># corrida reproducible</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># inicia con pesos aleatorios</span>

<span class="n">B</span> <span class="o">=</span> <span class="p">[</span><span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

<span class="n">errors2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">adaline_B</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">errors2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_74_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_74_0.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">adaline_C</span> <span class="o">=</span> <span class="n">Adaline</span><span class="p">(</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.00001</span><span class="p">,</span>  <span class="c1"># tasa de aprendizaje</span>
    <span class="n">max_epochs</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>  <span class="c1"># número máximo de iteraciones sobre el set de datos</span>
    <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># mezcla patrones para aprendizaje online</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>  <span class="c1"># corrida reproducible</span>
    <span class="n">warm_start</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="p">)</span>  <span class="c1"># inicia con pesos aleatorios</span>

<span class="n">C</span> <span class="o">=</span> <span class="p">[</span><span class="o">+</span><span class="mi">1</span> <span class="k">if</span> <span class="n">u</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">d</span><span class="p">]</span>

<span class="n">errors2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">adaline_C</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">errors2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_75_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_75_0.png" />
</div>
</div>
</div>
<div class="section" id="Fronteras-de-decisión">
<h3>Fronteras de decisión<a class="headerlink" href="#Fronteras-de-decisión" title="Enlazar permanentemente con este título"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">50</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">100</span><span class="p">:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">X</span><span class="p">[</span><span class="mi">100</span><span class="p">:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">,</span> <span class="n">adjustable</span><span class="o">=</span><span class="s2">&quot;box&quot;</span><span class="p">)</span>

<span class="n">xlim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">()</span>
<span class="n">ylim</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>

<span class="n">xplot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">num</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">fronteraA</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="n">adaline_A</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">/</span> <span class="n">adaline_A</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">-</span> <span class="n">adaline_A</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">adaline_A</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">xplot</span>
<span class="p">)</span>

<span class="n">fronteraB</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="n">adaline_B</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">/</span> <span class="n">adaline_B</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">-</span> <span class="n">adaline_B</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">adaline_B</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">xplot</span>
<span class="p">)</span>

<span class="n">fronteraC</span> <span class="o">=</span> <span class="p">(</span>
    <span class="o">-</span><span class="n">adaline_C</span><span class="o">.</span><span class="n">intercept_</span> <span class="o">/</span> <span class="n">adaline_C</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="o">-</span> <span class="n">adaline_C</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">adaline_C</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">xplot</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">fronteraA</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">fronteraB</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xplot</span><span class="p">,</span> <span class="n">fronteraC</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ylim</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_77_0.png" src="../../_images/notebooks_adaptive_linear_combiner_1-01_adaline_teoria_77_0.png" />
</div>
</div>
<p><img alt="AdalineClasificacion-03.png" src="../../_images/AdalineClasificacion-03.png" /></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2019-2021, Juan D. Velasquez.</p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-XXXXXXX-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-XXXXXXX-1', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>