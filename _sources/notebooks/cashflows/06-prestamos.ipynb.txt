{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "Préstamos\n",
    "===\n",
    "\n",
    "* *60 min* | Junio 22, 2019"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "**Preparación**"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true,
    "slideshow": {
     "slide_type": "-"
    }
   },
   "outputs": [],
   "source": [
    "# Importa la librería financiera.\n",
    "# Solo es necesario ejecutar la importación una sola vez.\n",
    "import cashflows as cf"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "### Bullet Loan\n",
    "\n",
    "`bullet_loan(amount, nrate, dispoints=0, orgpoints=0, prepmt=None)`\n",
    "\n",
    "En este tipo de préstamo se pagan únicamente intereses durante la vida del crédito; con la última cuota se paga el capital.\n",
    "\n",
    "* `amount` -- monto del crédito.\n",
    "* `nrate` -- tasa nominal de interés.\n",
    "* `dispoints` -- puntos (costo) de descuento como porcentaje de `amount`. Se consideran como intereses anticipados y son deducibles de impuestos.\n",
    "* `orgpoints` -- puntos (costo) de constitución como porcentaje de `amount`. Son costos no deducibles para el pago de impuestos. \n",
    "* `prepmt` -- flujo de efectivo que representa prepago de la deuda."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.-*** Modele un préstamo de  `$` 1000 a una tasa de interés del 10% y una duración de 10 años."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2017</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2017              0.0      10.0          0.0          0.0           0.0   \n",
       "2018           1000.0      10.0        100.0        100.0           0.0   \n",
       "2019           1000.0      10.0        100.0        100.0           0.0   \n",
       "2020           1000.0      10.0        100.0        100.0           0.0   \n",
       "2021           1000.0      10.0        100.0        100.0           0.0   \n",
       "2022           1000.0      10.0        100.0        100.0           0.0   \n",
       "2023           1000.0      10.0        100.0        100.0           0.0   \n",
       "2024           1000.0      10.0        100.0        100.0           0.0   \n",
       "2025           1000.0      10.0        100.0        100.0           0.0   \n",
       "2026           1000.0      10.0        100.0        100.0           0.0   \n",
       "2027           1000.0      10.0       1100.0        100.0        1000.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2017           1000.0  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023           1000.0  \n",
       "2024           1000.0  \n",
       "2025           1000.0  \n",
       "2026           1000.0  \n",
       "2027              0.0  "
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cf.bullet_loan(amount=1000, \n",
    "               nrate=cf.interest_rate(const_value=10, periods=11, start=2017, freq='A'), \n",
    "               dispoints=0, \n",
    "               orgpoints=0, \n",
    "               prepmt=None)  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2017</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2017              0.0      10.0          0.0          0.0           0.0   \n",
       "2018           1000.0      10.0        100.0        100.0           0.0   \n",
       "2019           1000.0      10.0        100.0        100.0           0.0   \n",
       "2020           1000.0      10.0        100.0        100.0           0.0   \n",
       "2021           1000.0      10.0        100.0        100.0           0.0   \n",
       "2022           1000.0      10.0        100.0        100.0           0.0   \n",
       "2023           1000.0      10.0        100.0        100.0           0.0   \n",
       "2024           1000.0      10.0        100.0        100.0           0.0   \n",
       "2025           1000.0      10.0        100.0        100.0           0.0   \n",
       "2026           1000.0      10.0        100.0        100.0           0.0   \n",
       "2027           1000.0      10.0       1100.0        100.0        1000.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2017           1000.0  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023           1000.0  \n",
       "2024           1000.0  \n",
       "2025           1000.0  \n",
       "2026           1000.0  \n",
       "2027              0.0  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## se puede asignar a una variable\n",
    "x = cf.bullet_loan(amount=1000, \n",
    "                   nrate=cf.interest_rate(const_value=10, periods=11, start=2017, freq='A'), \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0, \n",
    "                   prepmt=None)  \n",
    "x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2017      0.0\n",
       "2018    100.0\n",
       "2019    100.0\n",
       "2020    100.0\n",
       "2021    100.0\n",
       "2022    100.0\n",
       "2023    100.0\n",
       "2024    100.0\n",
       "2025    100.0\n",
       "2026    100.0\n",
       "2027    100.0\n",
       "Freq: A-DEC, Name: Int_Payment, dtype: float64"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## todos los tipos de créditos tiene funciones \n",
    "## para obtener las columnas de la tabla de \n",
    "## amortizacion como un flujo de efectivo\n",
    "x.Int_Payment"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1000.0"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sum(x.Int_Payment)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2017       0.0\n",
       "2018       0.0\n",
       "2019       0.0\n",
       "2020       0.0\n",
       "2021       0.0\n",
       "2022       0.0\n",
       "2023       0.0\n",
       "2024       0.0\n",
       "2025       0.0\n",
       "2026       0.0\n",
       "2027    1000.0\n",
       "Freq: A-DEC, Name: Ppal_Payment, dtype: float64"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.Ppal_Payment  ## pagos a capital"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2017       0.0\n",
       "2018    1000.0\n",
       "2019    1000.0\n",
       "2020    1000.0\n",
       "2021    1000.0\n",
       "2022    1000.0\n",
       "2023    1000.0\n",
       "2024    1000.0\n",
       "2025    1000.0\n",
       "2026    1000.0\n",
       "2027    1000.0\n",
       "Freq: A-DEC, Name: Beg_Ppal_Amount, dtype: float64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.Beg_Ppal_Amount ## balance inicial del período"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2017    1000.0\n",
       "2018    1000.0\n",
       "2019    1000.0\n",
       "2020    1000.0\n",
       "2021    1000.0\n",
       "2022    1000.0\n",
       "2023    1000.0\n",
       "2024    1000.0\n",
       "2025    1000.0\n",
       "2026    1000.0\n",
       "2027       0.0\n",
       "Freq: A-DEC, Name: End_Ppal_Amount, dtype: float64"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.End_Ppal_Amount ## balance final del período"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Para el crédito anterior, suponga que se hace un prepago de la deuda por `$` 500 en `t = 5`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>600.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>500.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>500.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>500.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>500.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>500.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>500.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>550.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>500.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        100.0        100.0           0.0   \n",
       "2020           1000.0      10.0        100.0        100.0           0.0   \n",
       "2021           1000.0      10.0        100.0        100.0           0.0   \n",
       "2022           1000.0      10.0        100.0        100.0           0.0   \n",
       "2023           1000.0      10.0        600.0        100.0         500.0   \n",
       "2024            500.0      10.0         50.0         50.0           0.0   \n",
       "2025            500.0      10.0         50.0         50.0           0.0   \n",
       "2026            500.0      10.0         50.0         50.0           0.0   \n",
       "2027            500.0      10.0         50.0         50.0           0.0   \n",
       "2028            500.0      10.0        550.0         50.0         500.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023            500.0  \n",
       "2024            500.0  \n",
       "2025            500.0  \n",
       "2026            500.0  \n",
       "2027            500.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## tasa de interés\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018)\n",
    "\n",
    "## prepago de duda\n",
    "prepmt = cf.cashflow(const_value=[0]*11, start=2018)\n",
    "prepmt[5] = 500\n",
    "\n",
    "## crédito\n",
    "cf.bullet_loan(amount=1000,\n",
    "               nrate=nrate, \n",
    "               dispoints=0, \n",
    "               orgpoints=0, \n",
    "               prepmt=prepmt) "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        100.0        100.0           0.0   \n",
       "2020           1000.0      10.0        100.0        100.0           0.0   \n",
       "2021           1000.0      10.0        100.0        100.0           0.0   \n",
       "2022           1000.0      10.0        100.0        100.0           0.0   \n",
       "2023           1000.0      10.0       1100.0        100.0        1000.0   \n",
       "2024              0.0      10.0          0.0          0.0           0.0   \n",
       "2025              0.0      10.0          0.0          0.0           0.0   \n",
       "2026              0.0      10.0          0.0          0.0           0.0   \n",
       "2027              0.0      10.0          0.0          0.0           0.0   \n",
       "2028              0.0      10.0          0.0          0.0           0.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023              0.0  \n",
       "2024              0.0  \n",
       "2025              0.0  \n",
       "2026              0.0  \n",
       "2027              0.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## Si el prepago es mayor que la deuda, se ajusta el saldo.\n",
    "prepmt = cf.cashflow(const_value=[0]*11, start=2018) \n",
    "prepmt[5] = 5000\n",
    "\n",
    "cf.bullet_loan(amount=1000,\n",
    "               nrate=nrate, \n",
    "               dispoints=0, \n",
    "               orgpoints=0, \n",
    "               prepmt=prepmt) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Modele el crédito anterior suponiendo que la tasa cambia al 8% a partir de `t = 6`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "scrolled": false,
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>1080.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        100.0        100.0           0.0   \n",
       "2020           1000.0      10.0        100.0        100.0           0.0   \n",
       "2021           1000.0      10.0        100.0        100.0           0.0   \n",
       "2022           1000.0      10.0        100.0        100.0           0.0   \n",
       "2023           1000.0       8.0         80.0         80.0           0.0   \n",
       "2024           1000.0       8.0         80.0         80.0           0.0   \n",
       "2025           1000.0       8.0         80.0         80.0           0.0   \n",
       "2026           1000.0       8.0         80.0         80.0           0.0   \n",
       "2027           1000.0       8.0         80.0         80.0           0.0   \n",
       "2028           1000.0       8.0       1080.0         80.0        1000.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023           1000.0  \n",
       "2024           1000.0  \n",
       "2025           1000.0  \n",
       "2026           1000.0  \n",
       "2027           1000.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018, chgpts={'2023':8}) \n",
    "\n",
    "cf.bullet_loan(amount=1000,\n",
    "               nrate=nrate, \n",
    "               dispoints=0, \n",
    "               orgpoints=0, \n",
    "               prepmt=None) \n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "### Balloon loan / tasa fija\n",
    "\n",
    "`fixed_rate_loan(amount, nrate, life, start, pyr=1, \n",
    "   grace=0, dispoints=0, orgpoints=0, prepmt=None, \n",
    "   balloonpmt=None)`\n",
    "\n",
    "\n",
    "En este tipo de crédito la tasa permanece fija durante toda la vida de la deuda. El pago periodico (intereses + capital) es constante. Admite la especificación de cuotas extras (*balloon payments*) pactadas desde el principio del crédito que tienen como fin reducir el pago períodico.\n",
    "\n",
    "\n",
    "* `amount` -- monto del crédito.\n",
    "* `nrate` -- tasa nominal de interés.\n",
    "* `life` -- plazo del crédito.\n",
    "* `start` -- especificación del período de inicio del crédito.\n",
    "* `pyr` -- número de periodos de capitalización por año para la tasa.\n",
    "* `grace` -- número de períodos de gracia antes del pago del capital.\n",
    "* `dispoints` -- puntos (costo) de descuento como porcentaje de `amount`. Se consideran como intereses anticipados y son deducibles de impuestos.\n",
    "* `orgpoints` -- puntos (costo) de constitución como porcentaje de `amount`. Son costos no deducibles para el pago de impuestos. \n",
    "* `prepmt` -- flujo de efectivo que representa prepago de la deuda.\n",
    "* `balloonpmt` -- pagos extra al pago períodico especificados como un objeto cashflow."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Modele un préstamo de  `$` 1000 a un plazo de 10 años, cuotas anuales y una tasa del 10%.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "scrolled": false,
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>62.745395</td>\n",
       "      <td>9.372546e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>937.254605</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>93.725461</td>\n",
       "      <td>69.019934</td>\n",
       "      <td>8.682347e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>868.234671</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>86.823467</td>\n",
       "      <td>75.921928</td>\n",
       "      <td>7.923127e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>792.312743</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>79.231274</td>\n",
       "      <td>83.514121</td>\n",
       "      <td>7.087986e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>708.798622</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>70.879862</td>\n",
       "      <td>91.865533</td>\n",
       "      <td>6.169331e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>616.933090</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>61.693309</td>\n",
       "      <td>101.052086</td>\n",
       "      <td>5.158810e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>515.881004</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>51.588100</td>\n",
       "      <td>111.157295</td>\n",
       "      <td>4.047237e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>404.723709</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>40.472371</td>\n",
       "      <td>122.273024</td>\n",
       "      <td>2.824507e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>282.450685</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>28.245069</td>\n",
       "      <td>134.500326</td>\n",
       "      <td>1.479504e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>147.950359</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>14.795036</td>\n",
       "      <td>147.950359</td>\n",
       "      <td>1.108447e-12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018      1000.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   162.745395   100.000000     62.745395   \n",
       "2020       937.254605      10.0   162.745395    93.725461     69.019934   \n",
       "2021       868.234671      10.0   162.745395    86.823467     75.921928   \n",
       "2022       792.312743      10.0   162.745395    79.231274     83.514121   \n",
       "2023       708.798622      10.0   162.745395    70.879862     91.865533   \n",
       "2024       616.933090      10.0   162.745395    61.693309    101.052086   \n",
       "2025       515.881004      10.0   162.745395    51.588100    111.157295   \n",
       "2026       404.723709      10.0   162.745395    40.472371    122.273024   \n",
       "2027       282.450685      10.0   162.745395    28.245069    134.500326   \n",
       "2028       147.950359      10.0   162.745395    14.795036    147.950359   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018     1.000000e+03  \n",
       "2019     9.372546e+02  \n",
       "2020     8.682347e+02  \n",
       "2021     7.923127e+02  \n",
       "2022     7.087986e+02  \n",
       "2023     6.169331e+02  \n",
       "2024     5.158810e+02  \n",
       "2025     4.047237e+02  \n",
       "2026     2.824507e+02  \n",
       "2027     1.479504e+02  \n",
       "2028     1.108447e-12  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cf.fixed_rate_loan(amount=1000, # monto\n",
    "                   nrate=10,    # tasa de interés\n",
    "                   freq='A',\n",
    "                   life=10,     # número de cuotas\n",
    "                   start=2018,\n",
    "                   grace=0,\n",
    "                   dispoints=0,\n",
    "                   orgpoints=0,\n",
    "                   prepmt=None,\n",
    "                   balloonpmt=None)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Considere el mismo crédito anterior. ¿Cómo se modifican los pagos períodicos, si se pacta un pago adicional de `$` 200 en los períodos 5 y 10?."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>27.964857</td>\n",
       "      <td>9.720351e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>972.035143</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>97.203514</td>\n",
       "      <td>30.761343</td>\n",
       "      <td>9.412738e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>941.273800</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>94.127380</td>\n",
       "      <td>33.837477</td>\n",
       "      <td>9.074363e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>907.436323</td>\n",
       "      <td>10.0</td>\n",
       "      <td>327.964857</td>\n",
       "      <td>90.743632</td>\n",
       "      <td>237.221225</td>\n",
       "      <td>6.702151e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>670.215099</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>67.021510</td>\n",
       "      <td>60.943347</td>\n",
       "      <td>6.092718e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>609.271751</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>60.927175</td>\n",
       "      <td>67.037682</td>\n",
       "      <td>5.422341e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>542.234070</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>54.223407</td>\n",
       "      <td>73.741450</td>\n",
       "      <td>4.684926e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>468.492620</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>46.849262</td>\n",
       "      <td>81.115595</td>\n",
       "      <td>3.873770e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>387.377025</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>38.737702</td>\n",
       "      <td>89.227155</td>\n",
       "      <td>2.981499e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>298.149870</td>\n",
       "      <td>10.0</td>\n",
       "      <td>327.964857</td>\n",
       "      <td>29.814987</td>\n",
       "      <td>298.149870</td>\n",
       "      <td>9.094947e-13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018      1000.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   127.964857   100.000000     27.964857   \n",
       "2020       972.035143      10.0   127.964857    97.203514     30.761343   \n",
       "2021       941.273800      10.0   127.964857    94.127380     33.837477   \n",
       "2022       907.436323      10.0   327.964857    90.743632    237.221225   \n",
       "2023       670.215099      10.0   127.964857    67.021510     60.943347   \n",
       "2024       609.271751      10.0   127.964857    60.927175     67.037682   \n",
       "2025       542.234070      10.0   127.964857    54.223407     73.741450   \n",
       "2026       468.492620      10.0   127.964857    46.849262     81.115595   \n",
       "2027       387.377025      10.0   127.964857    38.737702     89.227155   \n",
       "2028       298.149870      10.0   327.964857    29.814987    298.149870   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018     1.000000e+03  \n",
       "2019     9.720351e+02  \n",
       "2020     9.412738e+02  \n",
       "2021     9.074363e+02  \n",
       "2022     6.702151e+02  \n",
       "2023     6.092718e+02  \n",
       "2024     5.422341e+02  \n",
       "2025     4.684926e+02  \n",
       "2026     3.873770e+02  \n",
       "2027     2.981499e+02  \n",
       "2028     9.094947e-13  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "balloonpmt = cf.cashflow(const_value=[0]*11, start=2018)\n",
    "balloonpmt['2022'] = 200\n",
    "balloonpmt['2028'] = 200\n",
    "\n",
    "cf.fixed_rate_loan(amount=1000, # monto\n",
    "                   nrate=10,    # tasa de interés por período\n",
    "                   life=10,     # número de cuotas\n",
    "                   start='2018',\n",
    "                   grace=0,\n",
    "                   dispoints=0,\n",
    "                   orgpoints=0,\n",
    "                   prepmt=None,\n",
    "                   balloonpmt=balloonpmt)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Considere el caso anterior y un prepago de la deuda de `$` 100 en los períodos 3 y 7."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>27.964857</td>\n",
       "      <td>972.035143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>972.035143</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>97.203514</td>\n",
       "      <td>30.761343</td>\n",
       "      <td>941.273800</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>941.273800</td>\n",
       "      <td>10.0</td>\n",
       "      <td>227.964857</td>\n",
       "      <td>94.127380</td>\n",
       "      <td>133.837477</td>\n",
       "      <td>807.436323</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>807.436323</td>\n",
       "      <td>10.0</td>\n",
       "      <td>327.964857</td>\n",
       "      <td>80.743632</td>\n",
       "      <td>247.221225</td>\n",
       "      <td>560.215099</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>560.215099</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>56.021510</td>\n",
       "      <td>71.943347</td>\n",
       "      <td>488.271751</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>488.271751</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>48.827175</td>\n",
       "      <td>79.137682</td>\n",
       "      <td>409.134070</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>409.134070</td>\n",
       "      <td>10.0</td>\n",
       "      <td>227.964857</td>\n",
       "      <td>40.913407</td>\n",
       "      <td>187.051450</td>\n",
       "      <td>222.082620</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>222.082620</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.964857</td>\n",
       "      <td>22.208262</td>\n",
       "      <td>105.756595</td>\n",
       "      <td>116.326025</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>116.326025</td>\n",
       "      <td>10.0</td>\n",
       "      <td>127.958627</td>\n",
       "      <td>11.632602</td>\n",
       "      <td>116.326025</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018      1000.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   127.964857   100.000000     27.964857   \n",
       "2020       972.035143      10.0   127.964857    97.203514     30.761343   \n",
       "2021       941.273800      10.0   227.964857    94.127380    133.837477   \n",
       "2022       807.436323      10.0   327.964857    80.743632    247.221225   \n",
       "2023       560.215099      10.0   127.964857    56.021510     71.943347   \n",
       "2024       488.271751      10.0   127.964857    48.827175     79.137682   \n",
       "2025       409.134070      10.0   227.964857    40.913407    187.051450   \n",
       "2026       222.082620      10.0   127.964857    22.208262    105.756595   \n",
       "2027       116.326025      10.0   127.958627    11.632602    116.326025   \n",
       "2028         0.000000      10.0     0.000000     0.000000      0.000000   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018      1000.000000  \n",
       "2019       972.035143  \n",
       "2020       941.273800  \n",
       "2021       807.436323  \n",
       "2022       560.215099  \n",
       "2023       488.271751  \n",
       "2024       409.134070  \n",
       "2025       222.082620  \n",
       "2026       116.326025  \n",
       "2027         0.000000  \n",
       "2028         0.000000  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "prepmt = cf.cashflow(const_value=[0]*11, start=2018)\n",
    "prepmt['2021'] = 100\n",
    "prepmt['2025'] = 100\n",
    "\n",
    "cf.fixed_rate_loan(amount=1000, \n",
    "                   nrate=10,    \n",
    "                   life=10,     \n",
    "                   start=2018,\n",
    "                   grace=0,\n",
    "                   dispoints=0,\n",
    "                   orgpoints=0,\n",
    "                   prepmt=prepmt,\n",
    "                   balloonpmt=balloonpmt)\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Un crédito *bullet* puede modelarse como un crédito *balloon* usando un prepago al final igual al monto de la deuda."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "scrolled": false,
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.000000e+00</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.421085e-14</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>1100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>1.000000e+03</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018           1000.0      10.0          0.0          0.0  0.000000e+00   \n",
       "2019           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2020           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2021           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2022           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2023           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2024           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2025           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2026           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2027           1000.0      10.0        100.0        100.0  1.421085e-14   \n",
       "2028           1000.0      10.0       1100.0        100.0  1.000000e+03   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023           1000.0  \n",
       "2024           1000.0  \n",
       "2025           1000.0  \n",
       "2026           1000.0  \n",
       "2027           1000.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "balloonpmt = cf.cashflow(const_value=[0]*11, start=2018)\n",
    "balloonpmt['2028'] = 1000\n",
    "\n",
    "cf.fixed_rate_loan(amount=1000, \n",
    "                   nrate=10,    \n",
    "                   life=10,     \n",
    "                   start=2018,\n",
    "                   grace=0,\n",
    "                   dispoints=0,\n",
    "                   orgpoints=0,\n",
    "                   prepmt=None,\n",
    "                   balloonpmt=balloonpmt)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "### Abono constante a capital\n",
    "\n",
    "`fixed_ppal_loan(amount, nrate, grace=0, dispoints=0, orgpoints=0,\n",
    "   prepmt=None, balloonpmt=None)`\n",
    "\n",
    "En este tipo de crédito el abono al capital es una cantidad fija durante todos los períodos, de tal forma que el pago total por período es variable (ya que incluye los intereses pagados sobre el saldo de la deuda).\n",
    "\n",
    "* `amount` -- monto del crédito.\n",
    "* `nrate` -- tasa nominal de interés.\n",
    "* `grace` -- número de períodos de gracia antes del pago del capital.\n",
    "* `dispoints` -- puntos (costo) de descuento como porcentaje de `amount`. Se consideran como intereses anticipados y son deducibles de impuestos.\n",
    "* `orgpoints` -- puntos (costo) de constitución como porcentaje de `amount`. Son costos no deducibles para el pago de impuestos. \n",
    "* `prepmt` -- flujo de efectivo que representa prepago de la deuda.\n",
    "* `balloonpmt` -- pagos extra al pago períodico especificados como un objeto cashflow.\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "***Ejemplo.--*** Modele un crédito por `$` 1000 a 10 años y una tasa del 10%. Los pagos son anuales."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {
    "slideshow": {
     "slide_type": "fragment"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>200.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>900.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>900.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>190.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>800.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>800.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>180.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>700.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>700.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>170.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>600.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>600.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>160.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>500.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>400.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>400.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>300.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>300.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>130.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>200.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>120.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>100.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>110.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        200.0        100.0         100.0   \n",
       "2020            900.0      10.0        190.0         90.0         100.0   \n",
       "2021            800.0      10.0        180.0         80.0         100.0   \n",
       "2022            700.0      10.0        170.0         70.0         100.0   \n",
       "2023            600.0      10.0        160.0         60.0         100.0   \n",
       "2024            500.0      10.0        150.0         50.0         100.0   \n",
       "2025            400.0      10.0        140.0         40.0         100.0   \n",
       "2026            300.0      10.0        130.0         30.0         100.0   \n",
       "2027            200.0      10.0        120.0         20.0         100.0   \n",
       "2028            100.0      10.0        110.0         10.0         100.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019            900.0  \n",
       "2020            800.0  \n",
       "2021            700.0  \n",
       "2022            600.0  \n",
       "2023            500.0  \n",
       "2024            400.0  \n",
       "2025            300.0  \n",
       "2026            200.0  \n",
       "2027            100.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018)\n",
    "cf.fixed_ppal_loan(amount=1000, \n",
    "                   nrate=nrate, \n",
    "                   grace=0, \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0,\n",
    "                   prepmt=None, \n",
    "                   balloonpmt=None)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1000.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>242.857143</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>857.142857</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>857.142857</td>\n",
       "      <td>10.0</td>\n",
       "      <td>228.571429</td>\n",
       "      <td>85.714286</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>714.285714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>714.285714</td>\n",
       "      <td>10.0</td>\n",
       "      <td>214.285714</td>\n",
       "      <td>71.428571</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>571.428571</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>571.428571</td>\n",
       "      <td>10.0</td>\n",
       "      <td>200.000000</td>\n",
       "      <td>57.142857</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>428.571429</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>428.571429</td>\n",
       "      <td>10.0</td>\n",
       "      <td>185.714286</td>\n",
       "      <td>42.857143</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>285.714286</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>285.714286</td>\n",
       "      <td>10.0</td>\n",
       "      <td>171.428571</td>\n",
       "      <td>28.571429</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>142.857143</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>142.857143</td>\n",
       "      <td>10.0</td>\n",
       "      <td>157.142857</td>\n",
       "      <td>14.285714</td>\n",
       "      <td>142.857143</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018         0.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   100.000000   100.000000      0.000000   \n",
       "2020      1000.000000      10.0   100.000000   100.000000      0.000000   \n",
       "2021      1000.000000      10.0   100.000000   100.000000      0.000000   \n",
       "2022      1000.000000      10.0   242.857143   100.000000    142.857143   \n",
       "2023       857.142857      10.0   228.571429    85.714286    142.857143   \n",
       "2024       714.285714      10.0   214.285714    71.428571    142.857143   \n",
       "2025       571.428571      10.0   200.000000    57.142857    142.857143   \n",
       "2026       428.571429      10.0   185.714286    42.857143    142.857143   \n",
       "2027       285.714286      10.0   171.428571    28.571429    142.857143   \n",
       "2028       142.857143      10.0   157.142857    14.285714    142.857143   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018      1000.000000  \n",
       "2019      1000.000000  \n",
       "2020      1000.000000  \n",
       "2021      1000.000000  \n",
       "2022       857.142857  \n",
       "2023       714.285714  \n",
       "2024       571.428571  \n",
       "2025       428.571429  \n",
       "2026       285.714286  \n",
       "2027       142.857143  \n",
       "2028         0.000000  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## período de gracia de 3\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018)\n",
    "\n",
    "cf.fixed_ppal_loan(amount=1000, \n",
    "                   nrate=nrate, \n",
    "                   grace=3, \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0,\n",
    "                   prepmt=None, \n",
    "                   balloonpmt=None)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>200.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>900.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>900.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>190.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>800.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>800.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>180.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>700.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>700.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>170.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>600.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>600.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>160.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>500.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>400.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>400.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>132.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>300.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>300.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>200.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>116.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>100.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>108.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        200.0        100.0         100.0   \n",
       "2020            900.0      10.0        190.0         90.0         100.0   \n",
       "2021            800.0      10.0        180.0         80.0         100.0   \n",
       "2022            700.0      10.0        170.0         70.0         100.0   \n",
       "2023            600.0      10.0        160.0         60.0         100.0   \n",
       "2024            500.0       8.0        140.0         40.0         100.0   \n",
       "2025            400.0       8.0        132.0         32.0         100.0   \n",
       "2026            300.0       8.0        124.0         24.0         100.0   \n",
       "2027            200.0       8.0        116.0         16.0         100.0   \n",
       "2028            100.0       8.0        108.0          8.0         100.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019            900.0  \n",
       "2020            800.0  \n",
       "2021            700.0  \n",
       "2022            600.0  \n",
       "2023            500.0  \n",
       "2024            400.0  \n",
       "2025            300.0  \n",
       "2026            200.0  \n",
       "2027            100.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## este tipo de crédito admite una tasa de interés variable\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018, chgpts={'2024':8})\n",
    "\n",
    "cf.fixed_ppal_loan(amount=1000, \n",
    "                   nrate=nrate, \n",
    "                   grace=0, \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0,\n",
    "                   prepmt=None, \n",
    "                   balloonpmt=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>950.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>950.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>95.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>900.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>900.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>850.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>850.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>135.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>800.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>800.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>630.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>550.0</td>\n",
       "      <td>250.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>250.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>200.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>150.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>150.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>100.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>60.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>50.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>55.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        150.0        100.0          50.0   \n",
       "2020            950.0      10.0        145.0         95.0          50.0   \n",
       "2021            900.0      10.0        140.0         90.0          50.0   \n",
       "2022            850.0      10.0        135.0         85.0          50.0   \n",
       "2023            800.0      10.0        630.0         80.0         550.0   \n",
       "2024            250.0      10.0         75.0         25.0          50.0   \n",
       "2025            200.0      10.0         70.0         20.0          50.0   \n",
       "2026            150.0      10.0         65.0         15.0          50.0   \n",
       "2027            100.0      10.0         60.0         10.0          50.0   \n",
       "2028             50.0      10.0         55.0          5.0          50.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019            950.0  \n",
       "2020            900.0  \n",
       "2021            850.0  \n",
       "2022            800.0  \n",
       "2023            250.0  \n",
       "2024            200.0  \n",
       "2025            150.0  \n",
       "2026            100.0  \n",
       "2027             50.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## este tipo de crédito admite pagos adicionales \n",
    "## programados como abono a la deuda\n",
    "##\n",
    "nrate      = cf.interest_rate(const_value=[10]*11, start=2018)\n",
    "balloonpmt = cf.cashflow(const_value=[0]*11, start=2018)\n",
    "balloonpmt['2023'] = 500\n",
    "\n",
    "cf.fixed_ppal_loan(amount=1000, \n",
    "                   nrate=nrate, \n",
    "                   grace=0, \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0,\n",
    "                   prepmt=None, \n",
    "                   balloonpmt=balloonpmt)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>150.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>950.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>950.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>145.0</td>\n",
       "      <td>95.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>900.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>900.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>90.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>850.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>850.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>135.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>800.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>800.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>630.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>550.0</td>\n",
       "      <td>250.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>250.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>200.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>150.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>150.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>100.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>50.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>50.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>54.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>50.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        150.0        100.0          50.0   \n",
       "2020            950.0      10.0        145.0         95.0          50.0   \n",
       "2021            900.0      10.0        140.0         90.0          50.0   \n",
       "2022            850.0      10.0        135.0         85.0          50.0   \n",
       "2023            800.0      10.0        630.0         80.0         550.0   \n",
       "2024            250.0       8.0         70.0         20.0          50.0   \n",
       "2025            200.0       8.0         66.0         16.0          50.0   \n",
       "2026            150.0       8.0         62.0         12.0          50.0   \n",
       "2027            100.0       8.0         58.0          8.0          50.0   \n",
       "2028             50.0       8.0         54.0          4.0          50.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019            950.0  \n",
       "2020            900.0  \n",
       "2021            850.0  \n",
       "2022            800.0  \n",
       "2023            250.0  \n",
       "2024            200.0  \n",
       "2025            150.0  \n",
       "2026            100.0  \n",
       "2027             50.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 20,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## este tipo de crédito admite \n",
    "## una tasa de interés variable\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018, chgpts={'2024':8})\n",
    "balloonpmt = cf.cashflow(const_value=[0]*11,  start=2018)\n",
    "balloonpmt['2023'] = 500\n",
    "\n",
    "cf.fixed_ppal_loan(amount=1000, \n",
    "                   nrate=nrate, \n",
    "                   grace=0, \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0,\n",
    "                   prepmt=None, \n",
    "                   balloonpmt=balloonpmt)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>0.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1000.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>1000.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>600.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>500.0</td>\n",
       "      <td>500.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>500.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>140.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>400.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>400.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>132.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>300.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>300.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>124.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>200.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>200.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>116.0</td>\n",
       "      <td>16.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>100.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>100.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>108.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>100.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018              0.0      10.0          0.0          0.0           0.0   \n",
       "2019           1000.0      10.0        100.0        100.0           0.0   \n",
       "2020           1000.0      10.0        100.0        100.0           0.0   \n",
       "2021           1000.0      10.0        100.0        100.0           0.0   \n",
       "2022           1000.0      10.0        100.0        100.0           0.0   \n",
       "2023           1000.0      10.0        600.0        100.0         500.0   \n",
       "2024            500.0       8.0        140.0         40.0         100.0   \n",
       "2025            400.0       8.0        132.0         32.0         100.0   \n",
       "2026            300.0       8.0        124.0         24.0         100.0   \n",
       "2027            200.0       8.0        116.0         16.0         100.0   \n",
       "2028            100.0       8.0        108.0          8.0         100.0   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018           1000.0  \n",
       "2019           1000.0  \n",
       "2020           1000.0  \n",
       "2021           1000.0  \n",
       "2022           1000.0  \n",
       "2023            500.0  \n",
       "2024            400.0  \n",
       "2025            300.0  \n",
       "2026            200.0  \n",
       "2027            100.0  \n",
       "2028              0.0  "
      ]
     },
     "execution_count": 21,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## ejemplo anterior con período de gracia\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018, chgpts={'2024':8}) \n",
    "balloonpmt = cf.cashflow(const_value=[0]*11,  start=2018)\n",
    "balloonpmt['2023'] = 500\n",
    "\n",
    "cf.fixed_ppal_loan(amount=1000, \n",
    "                   nrate=nrate, \n",
    "                   grace=5, \n",
    "                   dispoints=0, \n",
    "                   orgpoints=0,\n",
    "                   prepmt=None, \n",
    "                   balloonpmt=balloonpmt)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "### Buydown loan\n",
    "\n",
    "`buydown_loan(amount, nrate, grace=0, dispoints=0, \n",
    "   orgpoints=0, prepmt=None)`\n",
    "\n",
    "Este tipo de préstamo es similar a los préstamos de cuota fija (balloon loans) pero con tasa cambiante en el tiempo. No admiten cuotas adicionales para reducir el pago fijo períodico. Cuando hay un cambio en la tasa de interés, el pago períodico total se recalcula para reflejar el cambio de tasa de interés.  \n",
    "\n",
    "* `amount` -- monto del crédito.\n",
    "* `nrate` -- tasa nominal de interés.\n",
    "* `grace` -- número de períodos de gracia antes del pago del capital.\n",
    "* `dispoints` -- puntos (costo) de descuento como porcentaje de `amount`. Se consideran como intereses anticipados y son deducibles de impuestos.\n",
    "* `orgpoints` -- puntos (costo) de constitución como porcentaje de `amount`. Son costos no deducibles para el pago de impuestos. \n",
    "* `prepmt` -- flujo de efectivo que representa prepago de la deuda.\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>62.745395</td>\n",
       "      <td>9.372546e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>937.254605</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>93.725461</td>\n",
       "      <td>69.019934</td>\n",
       "      <td>8.682347e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>868.234671</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>86.823467</td>\n",
       "      <td>75.921928</td>\n",
       "      <td>7.923127e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>792.312743</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>79.231274</td>\n",
       "      <td>83.514121</td>\n",
       "      <td>7.087986e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>708.798622</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>70.879862</td>\n",
       "      <td>91.865533</td>\n",
       "      <td>6.169331e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>616.933090</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>61.693309</td>\n",
       "      <td>101.052086</td>\n",
       "      <td>5.158810e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>515.881004</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>51.588100</td>\n",
       "      <td>111.157295</td>\n",
       "      <td>4.047237e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>404.723709</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>40.472371</td>\n",
       "      <td>122.273024</td>\n",
       "      <td>2.824507e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>282.450685</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>28.245069</td>\n",
       "      <td>134.500326</td>\n",
       "      <td>1.479504e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>147.950359</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>14.795036</td>\n",
       "      <td>147.950359</td>\n",
       "      <td>1.421085e-13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018      1000.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   162.745395   100.000000     62.745395   \n",
       "2020       937.254605      10.0   162.745395    93.725461     69.019934   \n",
       "2021       868.234671      10.0   162.745395    86.823467     75.921928   \n",
       "2022       792.312743      10.0   162.745395    79.231274     83.514121   \n",
       "2023       708.798622      10.0   162.745395    70.879862     91.865533   \n",
       "2024       616.933090      10.0   162.745395    61.693309    101.052086   \n",
       "2025       515.881004      10.0   162.745395    51.588100    111.157295   \n",
       "2026       404.723709      10.0   162.745395    40.472371    122.273024   \n",
       "2027       282.450685      10.0   162.745395    28.245069    134.500326   \n",
       "2028       147.950359      10.0   162.745395    14.795036    147.950359   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018     1.000000e+03  \n",
       "2019     9.372546e+02  \n",
       "2020     8.682347e+02  \n",
       "2021     7.923127e+02  \n",
       "2022     7.087986e+02  \n",
       "2023     6.169331e+02  \n",
       "2024     5.158810e+02  \n",
       "2025     4.047237e+02  \n",
       "2026     2.824507e+02  \n",
       "2027     1.479504e+02  \n",
       "2028     1.421085e-13  "
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## los resultados son iguales a un crédito balloon\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018)\n",
    "\n",
    "cf.buydown_loan(amount=1000, \n",
    "                nrate=nrate, \n",
    "                dispoints=0, \n",
    "                orgpoints=0, \n",
    "                prepmt=None)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>62.745395</td>\n",
       "      <td>9.372546e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>937.254605</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>93.725461</td>\n",
       "      <td>69.019934</td>\n",
       "      <td>8.682347e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>868.234671</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>86.823467</td>\n",
       "      <td>75.921928</td>\n",
       "      <td>7.923127e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>792.312743</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>79.231274</td>\n",
       "      <td>83.514121</td>\n",
       "      <td>7.087986e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>708.798622</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>70.879862</td>\n",
       "      <td>91.865533</td>\n",
       "      <td>6.169331e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>616.933090</td>\n",
       "      <td>5.0</td>\n",
       "      <td>142.495996</td>\n",
       "      <td>30.846654</td>\n",
       "      <td>111.649341</td>\n",
       "      <td>5.052837e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>505.283748</td>\n",
       "      <td>5.0</td>\n",
       "      <td>142.495996</td>\n",
       "      <td>25.264187</td>\n",
       "      <td>117.231808</td>\n",
       "      <td>3.880519e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>388.051940</td>\n",
       "      <td>5.0</td>\n",
       "      <td>142.495996</td>\n",
       "      <td>19.402597</td>\n",
       "      <td>123.093399</td>\n",
       "      <td>2.649585e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>264.958541</td>\n",
       "      <td>5.0</td>\n",
       "      <td>142.495996</td>\n",
       "      <td>13.247927</td>\n",
       "      <td>129.248069</td>\n",
       "      <td>1.357105e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>135.710472</td>\n",
       "      <td>5.0</td>\n",
       "      <td>142.495996</td>\n",
       "      <td>6.785524</td>\n",
       "      <td>135.710472</td>\n",
       "      <td>1.136868e-13</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018      1000.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   162.745395   100.000000     62.745395   \n",
       "2020       937.254605      10.0   162.745395    93.725461     69.019934   \n",
       "2021       868.234671      10.0   162.745395    86.823467     75.921928   \n",
       "2022       792.312743      10.0   162.745395    79.231274     83.514121   \n",
       "2023       708.798622      10.0   162.745395    70.879862     91.865533   \n",
       "2024       616.933090       5.0   142.495996    30.846654    111.649341   \n",
       "2025       505.283748       5.0   142.495996    25.264187    117.231808   \n",
       "2026       388.051940       5.0   142.495996    19.402597    123.093399   \n",
       "2027       264.958541       5.0   142.495996    13.247927    129.248069   \n",
       "2028       135.710472       5.0   142.495996     6.785524    135.710472   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018     1.000000e+03  \n",
       "2019     9.372546e+02  \n",
       "2020     8.682347e+02  \n",
       "2021     7.923127e+02  \n",
       "2022     7.087986e+02  \n",
       "2023     6.169331e+02  \n",
       "2024     5.052837e+02  \n",
       "2025     3.880519e+02  \n",
       "2026     2.649585e+02  \n",
       "2027     1.357105e+02  \n",
       "2028     1.136868e-13  "
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## cambios en la tasa de interés\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018, chgpts={'2024':5}) \n",
    "\n",
    "cf.buydown_loan(amount=1000, \n",
    "                nrate=nrate, \n",
    "                dispoints=0, \n",
    "                orgpoints=0, \n",
    "                prepmt=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {
    "scrolled": true,
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Beg_Ppal_Amount</th>\n",
       "      <th>Nom_Rate</th>\n",
       "      <th>Tot_Payment</th>\n",
       "      <th>Int_Payment</th>\n",
       "      <th>Ppal_Payment</th>\n",
       "      <th>End_Ppal_Amount</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000e+03</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>1000.000000</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>100.000000</td>\n",
       "      <td>62.745395</td>\n",
       "      <td>9.372546e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020</th>\n",
       "      <td>937.254605</td>\n",
       "      <td>10.0</td>\n",
       "      <td>162.745395</td>\n",
       "      <td>93.725461</td>\n",
       "      <td>69.019934</td>\n",
       "      <td>8.682347e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2021</th>\n",
       "      <td>868.234671</td>\n",
       "      <td>10.0</td>\n",
       "      <td>262.745395</td>\n",
       "      <td>86.823467</td>\n",
       "      <td>175.921928</td>\n",
       "      <td>6.923127e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2022</th>\n",
       "      <td>692.312743</td>\n",
       "      <td>10.0</td>\n",
       "      <td>142.204845</td>\n",
       "      <td>69.231274</td>\n",
       "      <td>72.973571</td>\n",
       "      <td>6.193392e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2023</th>\n",
       "      <td>619.339172</td>\n",
       "      <td>10.0</td>\n",
       "      <td>142.204845</td>\n",
       "      <td>61.933917</td>\n",
       "      <td>80.270928</td>\n",
       "      <td>5.390682e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2024</th>\n",
       "      <td>539.068245</td>\n",
       "      <td>10.0</td>\n",
       "      <td>242.204845</td>\n",
       "      <td>53.906824</td>\n",
       "      <td>188.298020</td>\n",
       "      <td>3.507702e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2025</th>\n",
       "      <td>350.770224</td>\n",
       "      <td>10.0</td>\n",
       "      <td>110.657765</td>\n",
       "      <td>35.077022</td>\n",
       "      <td>75.580742</td>\n",
       "      <td>2.751895e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2026</th>\n",
       "      <td>275.189482</td>\n",
       "      <td>10.0</td>\n",
       "      <td>110.657765</td>\n",
       "      <td>27.518948</td>\n",
       "      <td>83.138816</td>\n",
       "      <td>1.920507e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2027</th>\n",
       "      <td>192.050666</td>\n",
       "      <td>10.0</td>\n",
       "      <td>110.657765</td>\n",
       "      <td>19.205067</td>\n",
       "      <td>91.452698</td>\n",
       "      <td>1.005980e+02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2028</th>\n",
       "      <td>100.597968</td>\n",
       "      <td>10.0</td>\n",
       "      <td>110.657765</td>\n",
       "      <td>10.059797</td>\n",
       "      <td>100.597968</td>\n",
       "      <td>8.526513e-14</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Beg_Ppal_Amount  Nom_Rate  Tot_Payment  Int_Payment  Ppal_Payment  \\\n",
       "2018      1000.000000      10.0     0.000000     0.000000      0.000000   \n",
       "2019      1000.000000      10.0   162.745395   100.000000     62.745395   \n",
       "2020       937.254605      10.0   162.745395    93.725461     69.019934   \n",
       "2021       868.234671      10.0   262.745395    86.823467    175.921928   \n",
       "2022       692.312743      10.0   142.204845    69.231274     72.973571   \n",
       "2023       619.339172      10.0   142.204845    61.933917     80.270928   \n",
       "2024       539.068245      10.0   242.204845    53.906824    188.298020   \n",
       "2025       350.770224      10.0   110.657765    35.077022     75.580742   \n",
       "2026       275.189482      10.0   110.657765    27.518948     83.138816   \n",
       "2027       192.050666      10.0   110.657765    19.205067     91.452698   \n",
       "2028       100.597968      10.0   110.657765    10.059797    100.597968   \n",
       "\n",
       "      End_Ppal_Amount  \n",
       "2018     1.000000e+03  \n",
       "2019     9.372546e+02  \n",
       "2020     8.682347e+02  \n",
       "2021     6.923127e+02  \n",
       "2022     6.193392e+02  \n",
       "2023     5.390682e+02  \n",
       "2024     3.507702e+02  \n",
       "2025     2.751895e+02  \n",
       "2026     1.920507e+02  \n",
       "2027     1.005980e+02  \n",
       "2028     8.526513e-14  "
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "##\n",
    "## se introducen 2 prepagos por $ 100 cada uno\n",
    "## en t = 3, 6\n",
    "##\n",
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018) \n",
    "\n",
    "prepmt = cf.cashflow(const_value=[0]*11, start='2018')\n",
    "prepmt['2021'] = 100\n",
    "prepmt['2024'] = 100\n",
    "\n",
    "cf.buydown_loan(amount=1000, \n",
    "                nrate=nrate, \n",
    "                dispoints=0, \n",
    "                orgpoints=0, \n",
    "                prepmt=prepmt)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "`to_cashflow(tax_rate=0)`\n",
    "\n",
    "Convierte el crédito a un flujo de fondos equivalente.\n",
    "\n",
    "* `tax_rate` -- impuesto de renta. Se usa para tener en cuenta la reducción del pago por impuesto de renta debido a que los intereses son considerados como costo financiero deducible de impuestos."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2018    1000.000000\n",
       "2019    -262.745395\n",
       "2020    -256.470855\n",
       "2021    -349.568862\n",
       "2022    -211.436119\n",
       "2023    -204.138762\n",
       "2024    -296.111669\n",
       "2025    -145.734787\n",
       "2026    -138.176713\n",
       "2027    -129.862831\n",
       "2028    -120.717561\n",
       "Freq: A-DEC, dtype: float64"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018) \n",
    "\n",
    "prepmt = cf.cashflow(const_value=[0]*11, start='2018')\n",
    "prepmt['2021'] = 100\n",
    "prepmt['2024'] = 100\n",
    "\n",
    "cf.buydown_loan(amount=1000, \n",
    "                nrate=nrate, \n",
    "                dispoints=0, \n",
    "                orgpoints=0, \n",
    "                prepmt=prepmt).tocashflow()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "`true_rate(tax_rate=0)`\n",
    "\n",
    "\n",
    "Calcula la tasa real del interés del crédito. Permite la comparación de créditos. Para el cálculo, el préstamo es convertido al flujo de efectivo equivalente teniendo en cuenta lo siguiente:\n",
    "\n",
    "* Los puntos de causación son considerados como no deducibles y son ignorados en el cálculo del beneficio del impuesto de renta.\n",
    "\n",
    "* Los puntos de descuento son considerado como intereses prepagados y son deducibles de impuestos.\n",
    "\n",
    "* Si `tax_rate` es diferente de cero, la tasa de interés verdadera después de impuestos es calculada. Esto implica que en el cálculo solo la porción `(1-tax_rate)` de los intereses (incluyendo los puntos de descuento) es considerada en el cálculo.\n",
    "\n",
    "        \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "20.000000000000018"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nrate = cf.interest_rate(const_value=[10]*11, start=2018) \n",
    "\n",
    "prepmt = cf.cashflow(const_value=[0]*11, start='2018')\n",
    "prepmt['2021'] = 100\n",
    "prepmt['2024'] = 100\n",
    "\n",
    "cf.buydown_loan(amount=1000, \n",
    "                nrate=nrate, \n",
    "                dispoints=0, \n",
    "                orgpoints=0, \n",
    "                prepmt=prepmt).true_rate()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "**Ejercicio.--** Una empresa financiará la nueva construcción de una central de generación con los siguientes prestamos.\n",
    "\n",
    "* Un crédito con pagos fijos iguales por `$` 800 a 72 meses con un desembolso único en 2018-06. La tasa nominal de interés es del 25% nominal. La tasa cambia al 20% en 2020-03. \n",
    "\n",
    "\n",
    "* Un crédito con abono fijo a capital por `$` 700 a 80 meses con un desembolso único en 2018-09. La tasa nominal de interés es del 23% nominal. La tasa cambia al 19% en 2021-01. \n",
    "\n",
    "Calcule y grafique los intereses pagados por trimestre.\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "slideshow": {
     "slide_type": "slide"
    }
   },
   "source": [
    "**Bibliografía**\n",
    "\n",
    "> * [1] SAS/ETS 14.1 User's Guide, 2015.   \n",
    "* [2] **hp** 12c platinum financial calculator. User's guide. \n",
    "* [3] HP Business Consultant II Owner's manual.\n",
    "* [4] C.S. Park and G.P. Sharp-Bette. Advanced Engineering Economics. John Wiley & Sons, Inc., 1990."
   ]
  }
 ],
 "metadata": {
  "anaconda-cloud": {},
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
